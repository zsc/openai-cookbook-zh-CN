<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../../">
    <title>æ£€æŸ¥ Python ç‰ˆæœ¬</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="stylesheet" href="assets/highlight.css">
    <script src="assets/script.js" defer></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: false,
                packages: {'[+]': ['noerrors', 'ams']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            loader: {
                load: ['[tex]/noerrors', '[tex]/ams']
            }
        };
    </script>
</head>
<body>
    <div class="container">
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h3>ç›®å½•</h3>
                <button id="sidebar-toggle" class="sidebar-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
            <div class="sidebar-search">
                <input type="text" id="sidebar-search-input" placeholder="æœç´¢..." autocomplete="off">
            </div>
            <div id="tree-container">
                <nav class="tree-nav" role="tree">
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">extended_thinking</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="extended_thinking/extended_thinking_with_tool_use_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ‰©å±•æ€è€ƒä¸å·¥å…·ä½¿ç”¨</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="extended_thinking/extended_thinking_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ‰©å±•æ€è€ƒ</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">finetuning</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="finetuning/finetuning_on_bedrock_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">åœ¨ Bedrock ä¸Šå¾®è°ƒ Claude 3 Haiku</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">misc</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/batch_processing_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ‰¹é‡å¤„ç†æ¶ˆæ¯æ‰¹æ¬¡API</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/building_evals_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å»ºç«‹è¯„ä¼°</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/building_moderation_filter_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å»ºç«‹ä¸€ä¸ªå¸¦æœ‰ Claude çš„å®¡æ ¸è¿‡æ»¤å™¨</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/generate_test_cases_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰ `extract_variables` å‡½æ•°ï¼Œ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/how_to_enable_json_mode_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æç¤º Claude è·å–â€œJSON æ¨¡å¼â€</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/how_to_make_sql_queries_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¦‚ä½•ä½¿ç”¨ Claude è¿›è¡Œ SQL æŸ¥è¯¢</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/illustrated_responses_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude çš„å›¾ç¤ºåŒ–å“åº”</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/mc_qa_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å®éªŒæ€§æµ‹è¯• Claude çš„é•¿ä¸Šä¸‹æ–‡é—®ç­”èƒ½åŠ›</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/metaprompt_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Metaprompt</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/pdf_upload_summarization_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">â€œä¸Šä¼ â€PDF åˆ° Claude API</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/prompt_caching_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¼“å­˜æç¤ºï¼ˆPrompt cachingï¼‰é€šè¿‡ Anthropic API</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/read_web_pages_with_haiku_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Claude 3 Haiku æ€»ç»“ç½‘é¡µå†…å®¹</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/sampling_past_max_tokens_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude ä» Claude ä¹‹å¤–çš„é‡‡æ ·å“åº”ï¼Œè¶…å‡ºæœ€å¤§ä»¤ç‰Œé™åˆ¶</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/speculative_prompt_caching_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æŠ•æœºæ€§æç¤ºç¼“å­˜</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/using_citations_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¼•è¨€</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">multimodal</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/best_practices_for_vision_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/getting_started_with_vision_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¼€å§‹ä¸Šæ‰‹ - å¦‚ä½•å°†å›¾åƒä¼ é€’ç»™ Claude</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/how_to_transcribe_text_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¦‚ä½•ä½¿ç”¨ Claude è½¬å½•æ–‡æ¡£</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/reading_charts_graphs_powerpoints_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨å›¾è¡¨å’Œå¹»ç¯ç‰‡æ”¾æ˜ </span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/using_sub_agents_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Haiku ä½œä¸ºå­ä»£ç†</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">patterns</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">agents</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="patterns/agents/basic_workflows_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">é¦–å…ˆä½¿ç”¨å…·æœ‰æ€ç»´é“¾çš„LLMç¡®å®šé€‚å½“çš„è·¯ç”±</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="patterns/agents/evaluator_optimizer_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="patterns/agents/orchestrator_workers_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ­¥éª¤1ï¼šè·å–åè°ƒå™¨å“åº”</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="patterns/agents/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ„å»ºé«˜æ•ˆä»£ç†çš„é£Ÿè°±</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">prompts</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="patterns/agents/prompts/citations_agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="patterns/agents/prompts/research_lead_agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="patterns/agents/prompts/research_subagent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                </div></div></div></div></div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">skills</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="skills/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude æŠ€èƒ½</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">classification</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/classification/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è®¾ç½®æˆ‘ä»¬çš„ç¯å¢ƒ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/classification/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude åˆ†ç±»æŒ‡å—</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">evaluation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="skills/classification/evaluation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Promptfoo è¿›è¡Œè¯„ä¼°</span>
                        </a>
                    </div>
                </div></div></div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">contextual-embeddings</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/contextual-embeddings/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¢å¼ºæ£€ç´¢çš„RAGä¸ä¸Šä¸‹æ–‡æ£€ç´¢</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/contextual-embeddings/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç»“åˆä¸Šä¸‹æ–‡åµŒå…¥çš„æ£€ç´¢å¢å¼ºç”Ÿæˆ</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">retrieval_augmented_generation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/retrieval_augmented_generation/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Retrieval Augmented Generation (RAG)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/retrieval_augmented_generation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">evaluation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="skills/retrieval_augmented_generation/evaluation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Promptfoo è¿›è¡Œè¯„ä¼°</span>
                        </a>
                    </div>
                </div></div></div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">summarization</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/summarization/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ‘˜è¦ä¸ Claude</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/summarization/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude æ‘˜è¦</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">evaluation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="skills/summarization/evaluation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Promptfoo è¯„ä¼°</span>
                        </a>
                    </div>
                </div></div></div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">text_to_sql</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/text_to_sql/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Set your Anthropic API key</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/text_to_sql/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude çš„æ–‡æœ¬åˆ° SQL</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">evaluation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="skills/text_to_sql/evaluation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Promptfoo è¯„ä¼°</span>
                        </a>
                    </div>
                </div></div></div></div></div></div>
                    <div class="tree-folder expanded" data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">third_party</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">Deepgram</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/Deepgram/prerecorded_audio_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è½¬å½•æ·±è“éŸ³é¢‘æ–‡ä»¶å¹¶ä½¿ç”¨ Anthropic å‡†å¤‡é¢è¯•é—®é¢˜ï¼</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/Deepgram/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Deepgram <> Anthropic Cookbooks</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">LlamaIndex</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/Basic_RAG_With_LlamaIndex_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">RAG ç®¡é“ä¸ LlamaIndex</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/Multi_Document_Agents_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¤šæ–‡æ¡£ä»£ç†</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/Multi_Modal_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¤šæ¨¡æ€</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/ReAct_Agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ReAct Agent</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">LlamaIndex <> Anthropic Cookbooks</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/Router_Query_Engine_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ³¨æ„ï¼šè¿™ä»…åœ¨ jupyter notebook ä¸­æ˜¯å¿…éœ€çš„ã€‚</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/SubQuestion_Query_Engine_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">SubQuestionQueryEngine</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">MongoDB</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/MongoDB/rag_using_mongodb_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¦‚ä½•ä½¿ç”¨ Claude 3 å’Œ MongoDB æ„å»º RAG ç³»ç»Ÿ</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder expanded" data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">Pinecone</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item active" style="padding-left: 40px;">
                        <a href="third_party/Pinecone/claude_3_rag_agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ£€æŸ¥ Python ç‰ˆæœ¬</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/Pinecone/rag_using_pinecone_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Pinecone è¿›è¡Œæ£€ç´¢å¢å¼ºç”Ÿæˆ</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">VoyageAI</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/VoyageAI/how_to_create_embeddings_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è¿™å°†è‡ªåŠ¨ä½¿ç”¨ç¯å¢ƒå˜é‡VOYAGE_API_KEYã€‚</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">Wikipedia</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/Wikipedia/wikipedia-search-cookbook_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è¿­ä»£æœç´¢ç»´åŸºç™¾ç§‘ä¸ Claude</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">WolframAlpha</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/WolframAlpha/using_llm_api_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Wolfram Alpha LLM API ä½œä¸º Claude çš„å·¥å…·</span>
                        </a>
                    </div>
                </div></div></div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">tool_use</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/calculator_tool_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨è®¡ç®—å™¨å·¥å…·ä¸ Claude</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/customer_service_agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨å®¢æˆ·ç«¯å·¥å…·åˆ›å»ºå®¢æœä»£ç†</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/extracting_structured_json_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Claude å’Œå·¥å…·ä½¿ç”¨åŠŸèƒ½æå–ç»“æ„åŒ– JSON</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/memory_cookbook_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å®‰è£…ä¾èµ–</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/parallel_tools_claude_3_7_sonnet_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">åœ¨ Claude 3.7 Sonnet ä¸Šå¹¶è¡Œè°ƒç”¨å·¥å…·</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/tool_choice_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">é€‰æ‹©å·¥å…·</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/tool_use_with_pydantic_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è®°äº‹å·¥å…·ï¼Œæ”¯æŒ Pydantic å’Œ Anthropic å·¥å…·ä½¿ç”¨</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/vision_with_tools_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Vision ä¸å·¥å…·</span>
                        </a>
                    </div>
                </div></div></nav>
            </div>
        </nav>
        
        <main class="content">
            <article>
                <p>ä»¥ä¸‹æ˜¯æ‚¨æä¾›çš„ Python ä»£ç çš„ä¸­æ–‡ç¿»è¯‘ï¼š</p>
<pre class="codehilite"><code class="language-python"># æ£€æŸ¥ Python ç‰ˆæœ¬
!python --version
</code></pre>

<pre class="codehilite"><code>Python 3.10.12
</code></pre>

<h1 id="claude-3-rag-langchain-v1">Claude 3 RAG ä»£ç†ä¸ LangChain v1</h1>
<p>LangChain v1 å¸¦æ¥äº†è®¸å¤šå˜åŒ–ï¼Œåœ¨æ¯”è¾ƒ LangChain çš„ <code>0.0.3xx</code> ç‰ˆæœ¬å’Œ <code>0.1.x</code> ç‰ˆæœ¬æ—¶ï¼Œä½ ä¼šå‘ç°è®¸å¤šæ¨èçš„åšæ³•éƒ½å‘ç”Ÿäº†æ”¹å˜ã€‚ä»£ç†ï¼ˆagentsï¼‰çš„æƒ…å†µå°¤å…¶å¦‚æ­¤ã€‚</p>
<p>æˆ‘ä»¬åˆå§‹åŒ–å’Œä½¿ç”¨ä»£ç†çš„æ–¹å¼æ¯”ä»¥å‰æ›´æ¸…æ™°äº†â€”â€”å°½ç®¡ä»æœ‰è®¸å¤šæŠ½è±¡å±‚ï¼Œä½†æˆ‘ä»¬å¯ä»¥ï¼ˆå¹¶ä¸”è¢«é¼“åŠ±ï¼‰æ›´æ¥è¿‘ä»£ç†æœ¬èº«çš„é€»è¾‘ã€‚è¿™åˆçœ‹å¯èƒ½ä¼šæœ‰äº›ä»¤äººå›°æƒ‘ï¼Œä½†ä¸€æ—¦ç†è§£äº†ï¼Œæ–°é€»è¾‘ä¼šæ¯”ä»¥å‰çš„ç‰ˆæœ¬æ¸…æ™°å¾—å¤šã€‚</p>
<p>åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ LangChain v1 æ„å»ºä¸€ä¸ª RAG ä»£ç†ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ Claude 3 ä½œä¸ºæˆ‘ä»¬çš„ LLMï¼ŒVoyage AI ä½œä¸ºçŸ¥è¯†åµŒå…¥ï¼Œå¹¶ä½¿ç”¨ Pinecone æ¥æ”¯æŒæˆ‘ä»¬çš„çŸ¥è¯†æ£€ç´¢ã€‚</p>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®‰è£…æ‰€éœ€çš„ä¾èµ–é¡¹ï¼š</p>
<pre class="codehilite"><code class="language-python"># å®‰è£…å¿…è¦çš„åº“
!pip install -qU \
    langchain==0.1.11 \
    langchain-core==0.1.30 \
    langchain-community==0.0.27 \
    langchain-anthropic==0.1.4 \
    langchainhub==0.1.15 \
    anthropic==0.19.1 \
    voyageai==0.2.1 \
    pinecone-client==3.1.0 \
    datasets==2.16.1
</code></pre>

<pre class="codehilite"><code> [2K      [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” [0m  [32m848.6/848.6 kB [0m  [31m4.6 MB/s [0m eta  [36m0:00:00 [0m
 [2K      [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” [0m  [32m211.0/211.0 kB [0m  [31m18.5 MB/s [0m eta  [36m0:00:00 [0m
 [2K      [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” [0m  [32m507.1/507.1 kB [0m  [31m30.3 MB/s [0m eta  [36m0:00:00 [0m
 [2K      [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” [0m  [32m75.6/75.6 kB [0m  [31m8.7 MB/s [0m eta  [36m0:00:00 [0m
 [2K      [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” [0m  [32m115.3/115.3 kB [0m  [31m13.4 MB/s [0m eta  [36m0:00:00 [0m
 [2K      [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” [0m  [32m134.8/134.8 kB [0m  [31m15.0 MB/s [0m eta  [36m0:00:00 [0m
 [2K      [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” [0m  [32m77.8/77.8 kB [0m  [31m9.2 MB/s [0m eta  [36m0:00:00 [0m
 [2K      [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” [0m  [32m58.3/58.3 kB [0m  [31m6.8 MB/s [0m eta  [36m0:00:00 [0m
 [2K      [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” [0m  [32m134.8/134.8 kB [0m  [31m13.5 MB/s [0m eta  [36m0:00:00 [0m
 [?25h
</code></pre>

<p>ç„¶åè·å–æ‰€éœ€çš„ API å¯†é’¥ã€‚æˆ‘ä»¬å°†éœ€è¦ <a href="https://docs.anthropic.com/claude/reference/getting-started-with-the-api">Claude</a>ã€<a href="https://docs.voyageai.com/install/">Voyage AI</a> å’Œ <a href="https://docs.pinecone.io/docs/quickstart">Pinecone</a> çš„ API å¯†é’¥ã€‚</p>
<pre class="codehilite"><code class="language-python"># åœ¨æ­¤å¤„æ’å…¥æ‚¨çš„ API å¯†é’¥
ANTHROPIC_API_KEY=&quot;&lt;YOUR_ANTHROPIC_API_KEY&gt;&quot;
PINECONE_API_KEY=&quot;&lt;YOUR_PINECONE_API_KEY&gt;&quot;
VOYAGE_API_KEY=&quot;&lt;YOUR_VOYAGE_API_KEY&gt;&quot;
</code></pre>

<h2 id="_1">æŸ¥æ‰¾çŸ¥è¯†</h2>
<p>å¯¹äºä½¿ç”¨ RAG çš„ä»£ç†ï¼Œæˆ‘ä»¬éœ€è¦çš„ç¬¬ä¸€ä»¶äº‹æ˜¯è·å–çŸ¥è¯†çš„æ¥æºã€‚æˆ‘ä»¬å°†ä½¿ç”¨ AI ArXiv æ•°æ®é›†çš„ v2 ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬åœ¨ Hugging Face Datasets ä¸Šå¯äº <a href="https://huggingface.co/datasets/jamescalam/ai-arxiv2-chunks"><code>jamescalam/ai-arxiv2-chunks</code></a> æ‰¾åˆ°ã€‚</p>
<p><em>æ³¨æ„ï¼šæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯é¢„åˆ†å—çš„æ•°æ®é›†ã€‚åŸå§‹ç‰ˆæœ¬è¯·å‚è§ <a href="https://huggingface.co/datasets/jamescalam/ai-arxiv2"><code>jamescalam/ai-arxiv2</code></a>ã€‚</em></p>
<pre class="codehilite"><code class="language-python">from datasets import load_dataset

# åŠ è½½æ•°æ®é›†
dataset = load_dataset(&quot;jamescalam/ai-arxiv2-chunks&quot;, split=&quot;train[:20000]&quot;)
dataset
</code></pre>

<pre class="codehilite"><code>/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_token.py:88: UserWarning: 
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(



Downloading data:   0%|          | 0.00.00.00, ?B/s)



Generating train split: 0 examples [00:00, ? examples/s]





Dataset({
    features: ['doi', 'chunk-id', 'chunk', 'id', 'title', 'summary', 'source', 'authors', 'categories', 'comment', 'journal_ref', 'primary_category', 'published', 'updated', 'references'],
    num_rows: 20000
})
</code></pre>

<pre class="codehilite"><code class="language-python"># æ˜¾ç¤ºæ•°æ®é›†ä¸­çš„ç¬¬äºŒä¸ªæ¡ç›®
dataset[1]
</code></pre>

<pre class="codehilite"><code>{'doi': '2401.09350',
 'chunk-id': 1,
 'chunk': 'These neural networks and their training algorithms may be complex, and the scope of their impact broad and wide, but nonetheless they are simply functions in a high-dimensional space. A trained neural network takes a vector as input, crunches and transforms it in various ways, and produces another vector, often in some other space. An image may thereby be turned into a vector, a song into a sequence of vectors, and a social network as a structured collection of vectors. It seems as though much of human knowledge, or at least what is expressed as text, audio, image, and video, has a vector representation in one form or another.\nIt should be noted that representing data as vectors is not unique to neural networks and deep learning. In fact, long before learnt vector representations of pieces of dataÃ¢\x80\x94what is commonly known as Ã¢\x80\x9cembeddingsÃ¢\x80\x9dÃ¢\x80\x94came along, data was often encoded as hand-crafted feature vectors. Each feature quanti- fied into continuous or discrete values some facet of the data that was deemed relevant to a particular task (such as classification or regression). Vectors of that form, too, reflect our understanding of a real-world object or concept.',
 'id': '2401.09350#1',
 'title': 'Foundations of Vector Retrieval',
 'summary': 'Vectors are universal mathematical objects that can represent text, images,\nspeech, or a mix of these data modalities. That happens regardless of whether\ndata is represented by hand-crafted features or learnt embeddings. Collect a\nlarge enough quantity of such vectors and the question of retrieval becomes\nurgently relevant: Finding vectors that are more similar to a query vector.\nThis monograph is concerned with the question above and covers fundamental\nconcepts along with advanced data structures and algorithms for vector\nretrieval. In doing so, it recaps this fascinating topic and lowers barriers of\nentry into this rich area of research.',
 'source': 'http://arxiv.org/pdf/2401.09350',
 'authors': 'Sebastian Bruch',
 'categories': 'cs.DS, cs.IR',
 'comment': None,
 'journal_ref': None,
 'primary_category': 'cs.DS',
 'published': '20240117',
 'updated': '20240117',
 'references': []}
</code></pre>

<h2 id="_2">æ„å»ºçŸ¥è¯†åº“</h2>
<p>è¦æ„å»ºæˆ‘ä»¬çš„çŸ¥è¯†åº“ï¼Œæˆ‘ä»¬éœ€è¦ <em>ä¸¤æ ·ä¸œè¥¿</em>ï¼š</p>
<ol>
<li><strong>åµŒå…¥ï¼ˆEmbeddingsï¼‰</strong>ï¼šä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <code>VoyageEmbeddings</code>ï¼Œå®ƒéœ€è¦ <a href="https://dash.voyageai.com/api-keys">API å¯†é’¥</a>ã€‚</li>
<li><strong>å‘é‡æ•°æ®åº“ï¼ˆVector Databaseï¼‰</strong>ï¼šç”¨äºå­˜å‚¨å’ŒæŸ¥è¯¢æˆ‘ä»¬çš„åµŒå…¥ã€‚æˆ‘ä»¬ä½¿ç”¨ Pineconeï¼Œå®ƒåŒæ ·éœ€è¦ä¸€ä¸ª <a href="https://app.pinecone.io">å…è´¹ API å¯†é’¥</a>ã€‚</li>
</ol>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆå§‹åŒ–ä¸ Voyage AI çš„è¿æ¥å¹¶å®šä¹‰ä¸€ä¸ªç”¨äºåµŒå…¥çš„ <code>embed</code> å¯¹è±¡ï¼š</p>
<pre class="codehilite"><code class="language-python">from langchain_community.embeddings import VoyageEmbeddings

# åˆå§‹åŒ– VoyageEmbeddings
embed = VoyageEmbeddings(
    voyage_api_key=VOYAGE_API_KEY, model=&quot;voyage-2&quot;
)
</code></pre>

<p>ç„¶åï¼Œæˆ‘ä»¬åˆå§‹åŒ–ä¸ Pinecone çš„è¿æ¥ï¼š</p>
<pre class="codehilite"><code class="language-python">from pinecone import Pinecone

# é…ç½®å®¢æˆ·ç«¯
pc = Pinecone(api_key=PINECONE_API_KEY)
</code></pre>

<p>ç°åœ¨æˆ‘ä»¬è®¾ç½®ç´¢å¼•è§„èŒƒï¼Œè¿™å…è®¸æˆ‘ä»¬å®šä¹‰è¦åœ¨å…¶ä¸­éƒ¨ç½²ç´¢å¼•çš„äº‘æä¾›å•†å’ŒåŒºåŸŸã€‚æ‚¨å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°æ‰€æœ‰ <a href="https://docs.pinecone.io/docs/projects">å¯ç”¨æä¾›å•†å’ŒåŒºåŸŸçš„åˆ—è¡¨</a>ã€‚</p>
<pre class="codehilite"><code class="language-python">from pinecone import ServerlessSpec

# å®šä¹‰æœåŠ¡å™¨lessè§„èŒƒ
spec = ServerlessSpec(
    cloud=&quot;aws&quot;, region=&quot;us-west-2&quot;
)
</code></pre>

<p>åœ¨åˆ›å»ºç´¢å¼•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ Voyage AI åµŒå…¥æ¨¡å‹çš„ç»´åº¦ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªåµŒå…¥å¹¶æ£€æŸ¥å…¶é•¿åº¦è½»æ¾æ‰¾åˆ°ï¼š</p>
<pre class="codehilite"><code class="language-python"># è·å–åµŒå…¥ç»´åº¦
vec = embed.embed_documents([&quot;ello&quot;])
len(vec[0])
</code></pre>

<pre class="codehilite"><code>1024
</code></pre>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬ä½¿ç”¨åµŒå…¥ç»´åº¦å’Œä¸æ¨¡å‹å…¼å®¹çš„åº¦é‡ï¼ˆå¯ä»¥æ˜¯ä½™å¼¦ç›¸ä¼¼åº¦æˆ–ç‚¹ç§¯ï¼‰æ¥åˆ›å»ºç´¢å¼•ã€‚æˆ‘ä»¬è¿˜å°† <code>spec</code> ä¼ é€’ç»™ç´¢å¼•åˆå§‹åŒ–ã€‚</p>
<pre class="codehilite"><code class="language-python">import time

index_name = &quot;claude-3-rag&quot;

# æ£€æŸ¥ç´¢å¼•æ˜¯å¦å·²å­˜åœ¨ï¼ˆå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è¿è¡Œï¼Œåº”è¯¥ä¸å­˜åœ¨ï¼‰
if index_name not in pc.list_indexes().names():
    # å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºç´¢å¼•
    pc.create_index(
        index_name,
        dimension=len(vec[0]),  # voyage æ¨¡å‹çš„ç»´åº¦
        metric='dotproduct',
        spec=spec
    )
    # ç­‰å¾…ç´¢å¼•åˆå§‹åŒ–
    while not pc.describe_index(index_name).status['ready']:
        time.sleep(1)

# è¿æ¥åˆ°ç´¢å¼•
index = pc.Index(index_name)
time.sleep(1)
# æŸ¥çœ‹ç´¢å¼•ç»Ÿè®¡ä¿¡æ¯
index.describe_index_stats()
</code></pre>

<pre class="codehilite"><code>{'dimension': 1024,
 'index_fullness': 0.0,
 'namespaces': {'': {'vector_count': 20000}},
 'total_vector_count': 20000}
</code></pre>

<h3 id="_3">å¡«å……æˆ‘ä»¬çš„ç´¢å¼•</h3>
<p>ç°åœ¨æˆ‘ä»¬çš„çŸ¥è¯†åº“å·²å‡†å¤‡å¥½å¡«å……æ•°æ®ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ <code>embed</code> è¾…åŠ©å‡½æ•°æ¥åµŒå…¥æˆ‘ä»¬çš„æ–‡æ¡£ï¼Œç„¶åå°†å®ƒä»¬æ·»åŠ åˆ°ç´¢å¼•ä¸­ã€‚</p>
<p>æˆ‘ä»¬è¿˜å°†åŒ…å«æ¯ä¸ªè®°å½•çš„å…ƒæ•°æ®ã€‚</p>
<pre class="codehilite"><code class="language-python">from tqdm.auto import tqdm

# å°†æ•°æ®é›†è½¬æ¢ä¸º pandas DataFrame ä»¥ä¾¿æ›´å®¹æ˜“å¤„ç†
data = dataset.to_pandas()

batch_size = 100

# éå†æ•°æ®æ‰¹æ¬¡
for i in tqdm(range(0, len(data), batch_size)):
    i_end = min(len(data), i+batch_size)
    # è·å–æ•°æ®æ‰¹æ¬¡
    batch = data.iloc[i:i_end]
    # ä¸ºæ¯ä¸ªå—ç”Ÿæˆå”¯ä¸€ ID
    ids = [f&quot;{x['doi']}-{x['chunk-id']}&quot; for i, x in batch.iterrows()]
    # è·å–è¦åµŒå…¥çš„æ–‡æœ¬
    texts = [x['chunk'] for _, x in batch.iterrows()]
    # åµŒå…¥æ–‡æœ¬
    embeds = embed.embed_documents(texts)
    # è·å–è¦åœ¨ Pinecone ä¸­å­˜å‚¨çš„å…ƒæ•°æ®
    metadata = [
        {'text': x['chunk'],
         'source': x['source'],
         'title': x['title']} for i, x in batch.iterrows()
    ]
    # æ·»åŠ åˆ° Pinecone
    index.upsert(vectors=zip(ids, embeds, metadata))
</code></pre>

<pre class="codehilite"><code>  0%|          | 0/200 [00:00&lt;?, ?it/s]
</code></pre>

<p>ä¸ºä»£ç†åˆ›å»ºä¸€ä¸ªç”¨äºæœç´¢ ArXiv è®ºæ–‡çš„å·¥å…·ï¼š</p>
<pre class="codehilite"><code class="language-python">from langchain.agents import tool

@tool
def arxiv_search(query: str) -&gt; str:
    &quot;&quot;&quot;å½“å›ç­”å…³äº AIã€æœºå™¨å­¦ä¹ ã€æ•°æ®ç§‘å­¦æˆ–å¯èƒ½é€šè¿‡ arXiv è®ºæ–‡å›ç­”çš„å…¶ä»–æŠ€æœ¯é—®é¢˜æ—¶ï¼Œè¯·ä½¿ç”¨æ­¤å·¥å…·ã€‚
    &quot;&quot;&quot;
    # åˆ›å»ºæŸ¥è¯¢å‘é‡
    xq = embed.embed_query(query)
    # æ‰§è¡Œæœç´¢
    out = index.query(vector=xq, top_k=5, include_metadata=True)
    # å°†ç»“æœé‡æ–°æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²
    results_str = &quot;\n\n&quot;.join(
        [x[&quot;metadata&quot;][&quot;text&quot;] for x in out[&quot;matches&quot;]]
    )
    return results_str

tools = [arxiv_search]
</code></pre>

<p>å½“æˆ‘ä»¬çš„ä»£ç†ä½¿ç”¨æ­¤å·¥å…·æ—¶ï¼Œå®ƒå°†å¦‚ä¸‹æ‰§è¡Œï¼š</p>
<pre class="codehilite"><code class="language-python"># æ‰“å° arxiv_search å·¥å…·çš„è¿è¡Œç»“æœ
print(
    arxiv_search.run(tool_input={&quot;query&quot;: &quot;can you tell me about llama 2?&quot;})
)
</code></pre>

<pre class="codehilite"><code>Model Llama 2 Code Llama Code Llama - Python Size FIM LCFT Python CPP Java PHP TypeScript C# Bash Average 7B Ã¢Å“â€” 13B Ã¢Å“â€” 34B Ã¢Å“â€” 70B Ã¢Å“â€” 7B Ã¢Å“â€” 7B Ã¢Å“â€œ 7B Ã¢Å“â€” 7B Ã¢Å“â€œ 13B Ã¢Å“â€” 13B Ã¢Å“â€œ 13B Ã¢Å“â€” 13B Ã¢Å“â€œ 34B Ã¢Å“â€” 34B Ã¢Å“â€” 7B Ã¢Å“â€” 7B Ã¢Å“â€” 13B Ã¢Å“â€” 13B Ã¢Å“â€” 34B Ã¢Å“â€” 34B Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€” 14.3% 6.8% 10.8% 9.9% 19.9% 13.7% 15.8% 13.0% 24.2% 23.6% 22.2% 19.9% 27.3% 30.4% 31.6% 34.2% 12.6% 13.2% 21.4% 15.1% 6.3% 3.2% 8.3% 9.5% 3.2% 12.6% 17.1% 3.8% 18.9% 25.9% 8.9% 24.8% Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€œ Ã¢Å“â€œ Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€œ Ã¢Å“â€œ Ã¢Å“â€” Ã¢Å“â€œ 37.3% 31.1% 36.1% 30.4% 29.2% 29.8% 38.0%

Ethical Considerations and Limitations (Section 5.2) Llama 2 is a new technology that carries risks with use. Testing conducted to date has been in English, and has not covered, nor could it cover all scenarios. For these reasons, as with all LLMs, Llama 2Ã¢â‚¬â„¢s potential outputs cannot be predicted in advance, and the model may in some instances produce inaccurate or objectionable responses to user prompts. Therefore, before deploying any applications of Llama 2, developers should perform safety testing and tuning tailored to their speciÃ¯Â¬ c applications of the model. Please see the Responsible Use Guide available available at https://ai.meta.com/llama/responsible-user-guide
Table 52: Model card for Llama 2.
77

2
Cove Liama Long context (7B =, 13B =, 34B) + fine-tuning ; Lrama 2 Code training 20B oes Cope Liama - Instruct Foundation models Ã¢â‚¬â€&gt; nfilling code training = eee.Ã¢â‚¬  (7B =, 13B =, 34B) Ã¢â‚¬â€ 5B (7B, 13B, 348) 5008 Python code Long context Cove Liama - PyrHon (7B, 13B, 34B) &gt; training Ã‚Â» Fine-tuning &gt; 1008 208
Figure 2: The Code Llama specialization pipeline. The different stages of fine-tuning annotated with the number of tokens seen during training. Infilling-capable models are marked with the Ã¢â€¡â€ symbol.
# 2 Code Llama: Specializing Llama 2 for code
# 2.1 The Code Llama models family

# 2 Code Llama: Specializing Llama 2 for code
# 2.1 The Code Llama models family
Code Llama. The Code Llama models constitute foundation models for code generation. They come in four model sizes: 7B, 13B, 34B and 70B parameters. The 7B, 13B and 70B models are trained using an infilling objective (Section 2.3), and are appropriate to be used in an IDE to complete code in the middle of a file, for example. The 34B model was trained without the infilling objective. All Code Llama models are initialized with Llama 2 model weights and trained on 500B tokens from a code-heavy dataset (see Section 2.2 for more details), except Code Llama 70B which was trained on 1T tokens. They are all fine-tuned to handle long contexts as detailed in Section 2.4.

0.52 0.57 0.19 0.30 Llama 1 7B 13B 33B 65B 0.27 0.24 0.23 0.25 0.26 0.24 0.26 0.26 0.34 0.31 0.34 0.34 0.54 0.52 0.50 0.46 0.36 0.37 0.36 0.36 0.39 0.37 0.35 0.40 0.26 0.23 0.24 0.25 0.28 0.28 0.33 0.32 0.33 0.31 0.34 0.32 0.45 0.50 0.49 0.48 0.33 0.27 0.31 0.31 0.17 0.10 0.12 0.11 0.24 0.24 0.23 0.25 0.31 0.27 0.30 0.30 0.44 0.41 0.41 0.43 0.57 0.55 0.60 0.60 0.39 0.34 0.28 0.39 Llama 2 7B 13B 34B 70B 0.28 0.24 0.27 0.31 0.25 0.25 0.24 0.29 0.29 0.35 0.33 0.35 0.50 0.50 0.56 0.51 0.36 0.41 0.41

Ethical Considerations and Limitations (Section 5.2) Llama 2 is a new technology that carries risks with use. Testing conducted to date has been in English, and has not covered, nor could it cover all scenarios. For these reasons, as with all LLMs, Llama 2Ã¢â‚¬â„¢s potential outputs cannot be predicted in advance, and the model may in some instances produce inaccurate or objectionable responses to user prompts. Therefore, before deploying any applications of Llama 2, developers should perform safety testing and tuning tailored to their speciÃ¯Â¬ c applications of the model. Please see the Responsible Use Guide available available at https://ai.meta.com/llama/responsible-user-guide
Table 52: Model card for Llama 2.
77

2
Cove Liama Long context (7B =, 13B =, 34B) + fine-tuning ; Lrama 2 Code training 20B oes Cope Liama - Instruct Foundation models Ã¢â‚¬â€&gt; nfilling code training = eee.Ã¢â‚¬  (7B =, 13B =, 34B) Ã¢â‚¬â€ 5B (7B, 13B, 348) 5008 Python code Long context Cove Liama - PyrHon (7B, 13B, 34B) &gt; training Ã‚Â» Fine-tuning &gt; 1008 208
Figure 2: The Code Llama specialization pipeline. The different stages of fine-tuning annotated with the number of tokens seen during training. Infilling-capable models are marked with the Ã¢â€¡â€ symbol.
# 2 Code Llama: Specializing Llama 2 for code
# 2.1 The Code Llama models family

0.52 0.57 0.19 0.30 Llama 1 7B 13B 33B 65B 0.27 0.24 0.23 0.25 0.26 0.24 0.26 0.26 0.34 0.31 0.34 0.34 0.54 0.52 0.50 0.46 0.36 0.37 0.36 0.36 0.39 0.37 0.35 0.40 0.26 0.23 0.24 0.25 0.28 0.28 0.33 0.32 0.33 0.31 0.34 0.32 0.45 0.50 0.49 0.48 0.33 0.27 0.31 0.31 0.17 0.10 0.12 0.11 0.24 0.24 0.23 0.25 0.31 0.27 0.30 0.30 0.44 0.41 0.41 0.43 0.57 0.55 0.60 0.60 0.39 0.34 0.28 0.39 Llama 2 7B 13B 34B 70B 0.28 0.24 0.27 0.31 0.25 0.25 0.24 0.29 0.29 0.35 0.33 0.35 0.50 0.50 0.56 0.51 0.36 0.41 0.41

Ethical Considerations and Limitations (Section 5.2) Llama 2 is a new technology that carries risks with use. Testing conducted to date has been in English, and has not covered, nor could it cover all scenarios. For these reasons, as with all LLMs, Llama 2Ã¢â‚¬â„¢s potential outputs cannot be predicted in advance, and the model may in some instances produce inaccurate or objectionable responses to user prompts. Therefore, before deploying any applications of Llama 2, developers should perform safety testing and tuning tailored to their speciÃ¯Â¬ c applications of the model. Please see the Responsible Use Guide available available at https://ai.meta.com/llama/responsible-user-guide
Table 52: Model card for Llama 2.
77

Model Size FIM LCFT HumanEval MBPP pass@1 pass@10 pass@100 pass@1 pass@10 pass@100 Llama 2 Code Llama Code Llama - Python 7B Ã¢Å“â€” 13B Ã¢Å“â€” 34B Ã¢Å“â€” 70B Ã¢Å“â€” 7B Ã¢Å“â€” 7B Ã¢Å“â€œ 7B Ã¢Å“â€” 7B Ã¢Å“â€œ 13B Ã¢Å“â€” 13B Ã¢Å“â€œ 13B Ã¢Å“â€” 13B Ã¢Å“â€œ 34B Ã¢Å“â€” 34B Ã¢Å“â€” 7B Ã¢Å“â€” 7B Ã¢Å“â€” 13B Ã¢Å“â€” 13B Ã¢Å“â€” 34B Ã¢Å“â€” 34B Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€œ Ã¢Å“â€œ Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€œ Ã¢Å“â€œ Ã¢Å“â€” Ã¢Å“â€œ Ã¢Å“â€” Ã¢Å“â€œ Ã¢Å“â€” Ã¢Å“â€œ Ã¢Å“â€” Ã¢Å“â€œ 12.2% 25.2% 20.1% 34.8% 22.6% 47.0% 30.5% 59.4% 32.3% 63.9% 34.1% 62.6% 34.1% 62.5% 33.5% 59.6% 36.6% 72.9% 36.6% 71.9% 37.8% 70.6% 36.0% 69.4% 48.2% 77.7% 48.8% 76.8% 40.2% 70.0% 38.4% 70.3% 45.7% 80.0% [0m

&lt;final_answer&gt;

- Llama 2 æ˜¯ç”± Meta AI å¼€å‘çš„å¤§å‹è¯­è¨€æ¨¡å‹ï¼Œæœ‰ 7B åˆ° 70B å‚æ•°çš„ä¸åŒå°ºå¯¸ã€‚

- Code Llama æ˜¯ Llama 2 çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œé€šè¿‡åœ¨ä»£ç æ•°æ®é›†ä¸Šè¿›è¡Œå¾®è°ƒï¼Œä¸“é—¨ç”¨äºä»£ç ç”Ÿæˆã€‚Code Llama æ¨¡å‹æœ‰ Pythonã€C++ã€Javaã€PHPã€TypeScriptã€C# å’Œ Bash ç‰ˆæœ¬ã€‚

- Code Llama çš„ä¸“é—¨åŒ–æµç¨‹åŒ…æ‹¬åŸºç¡€æ¨¡å‹é¢„è®­ç»ƒã€é•¿ä¸Šä¸‹æ–‡è®­ç»ƒã€ä»£ç å¡«å……è®­ç»ƒä»¥åŠé’ˆå¯¹ç‰¹å®šç¼–ç¨‹è¯­è¨€çš„å¾®è°ƒã€‚

- åœ¨ä»£ç ç”ŸæˆåŸºå‡†æµ‹è¯•ï¼ˆå¦‚ HumanEval å’Œ MBPPï¼‰ä¸Šï¼ŒCode Llama çš„è¡¨ç°æ˜æ˜¾ä¼˜äºåŸºç¡€ Llama 2 æ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œ34B å‚æ•°çš„ Code Llama - Python åœ¨ HumanEval ä¸Šçš„ pass@1 å‡†ç¡®ç‡ä¸º 48.8%ï¼Œè€Œ 34B çš„ Llama 2 ä¸º 34.1%ã€‚

- ä¸æ‰€æœ‰å¤§å‹è¯­è¨€æ¨¡å‹ä¸€æ ·ï¼ŒLlama 2 ä¹Ÿæœ‰å±€é™æ€§å’Œæ½œåœ¨é£é™©ï¼Œåœ¨éƒ¨ç½²åˆ°åº”ç”¨ç¨‹åºä¹‹å‰éœ€è¦è€ƒè™‘è¿™äº›ã€‚Meta æä¾›äº†ä¸€ä»½è´Ÿè´£ä»»çš„ä½¿ç”¨æŒ‡å—ï¼Œå…¶ä¸­åŒ…å«å®‰å…¨æµ‹è¯•å’Œè°ƒæ•´çš„å»ºè®®ã€‚

&lt;/final_answer&gt;
</code></pre>

<p>çœ‹èµ·æ¥æ•ˆæœä¸é”™ï¼Œä½†ç›®å‰æˆ‘ä»¬çš„ä»£ç†æ˜¯_æ— çŠ¶æ€_çš„ï¼Œè¿™ä½¿å¾—è¿›è¡Œå¯¹è¯å˜å¾—å›°éš¾ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼ä¸ºå…¶æ·»åŠ è®°å¿†ï¼Œä½†æœ€ç®€å•çš„æ–¹æ³•ä¹‹ä¸€æ˜¯ä½¿ç”¨ <code>ConversationBufferWindowMemory</code>ã€‚</p>
<pre class="codehilite"><code class="language-python">from langchain.chains.conversation.memory import ConversationBufferWindowMemory

# å¯¹è¯è®°å¿†
conversational_memory = ConversationBufferWindowMemory(
    memory_key='chat_history',
    k=5,
    return_messages=True
)
</code></pre>

<p>æˆ‘ä»¬è¿˜æ²¡æœ‰å°†å¯¹è¯è®°å¿†é™„åŠ åˆ°æˆ‘ä»¬çš„ä»£ç†ä¸Šâ€”â€”å› æ­¤ <code>conversational_memory</code> å¯¹è±¡å°†ä¿æŒä¸ºç©ºï¼š</p>
<pre class="codehilite"><code class="language-python">conversational_memory.chat_memory.messages
</code></pre>

<pre class="codehilite"><code>[]
</code></pre>

<p>æˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨å°†æˆ‘ä»¬ä¸ä»£ç†çš„äº¤äº’æ·»åŠ åˆ°æˆ‘ä»¬çš„è®°å¿†ä¸­ã€‚</p>
<pre class="codehilite"><code class="language-python"># æ·»åŠ ç”¨æˆ·æ¶ˆæ¯å’Œ AI å“åº”åˆ°è®°å¿†ä¸­
user_msg = &quot;can you tell me about llama 2?&quot;
out = agent_executor.invoke({
    &quot;input&quot;: user_msg,
    &quot;chat_history&quot;: &quot;&quot;
})
conversational_memory.chat_memory.add_user_message(user_msg)
conversational_memory.chat_memory.add_ai_message(out[&quot;output&quot;])

# æ˜¾ç¤ºè®°å¿†ä¸­çš„æ¶ˆæ¯
conversational_memory.chat_memory.messages
</code></pre>

<pre class="codehilite"><code>[HumanMessage(content='can you tell me about llama 2?'),
 AIMessage(content='\n- Llama 2 æ˜¯ç”± Meta AI å¼€å‘çš„å¤§å‹è¯­è¨€æ¨¡å‹ï¼Œæœ‰ 7B åˆ° 70B å‚æ•°çš„ä¸åŒå°ºå¯¸ã€‚\n\n- Code Llama æ˜¯ Llama 2 çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œé€šè¿‡åœ¨ä»£ç æ•°æ®é›†ä¸Šè¿›è¡Œå¾®è°ƒï¼Œä¸“é—¨ç”¨äºä»£ç ç”Ÿæˆã€‚Code Llama æ¨¡å‹æœ‰ Pythonã€C++ã€Javaã€PHPã€TypeScriptã€C# å’Œ Bash ç‰ˆæœ¬ã€‚\n\n- Code Llama çš„ä¸“é—¨åŒ–æµç¨‹åŒ…æ‹¬åŸºç¡€æ¨¡å‹é¢„è®­ç»ƒã€é•¿ä¸Šä¸‹æ–‡è®­ç»ƒã€ä»£ç å¡«å……è®­ç»ƒä»¥åŠé’ˆå¯¹ç‰¹å®šç¼–ç¨‹è¯­è¨€çš„å¾®è°ƒã€‚\n\n- åœ¨ä»£ç ç”ŸæˆåŸºå‡†æµ‹è¯•ï¼ˆå¦‚ HumanEval å’Œ MBPPï¼‰ä¸Šï¼ŒCode Llama çš„è¡¨ç°æ˜æ˜¾ä¼˜äºåŸºç¡€ Llama 2 æ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œ34B å‚æ•°çš„ Code Llama - Python åœ¨ HumanEval ä¸Šçš„ pass@1 å‡†ç¡®ç‡ä¸º 48.8%ï¼Œè€Œ 34B çš„ Llama 2 ä¸º 34.1%ã€‚\n\n- ä¸æ‰€æœ‰å¤§å‹è¯­è¨€æ¨¡å‹ä¸€æ ·ï¼ŒLlama 2 ä¹Ÿæœ‰å±€é™æ€§å’Œæ½œåœ¨é£é™©ï¼Œåœ¨éƒ¨ç½²åˆ°åº”ç”¨ç¨‹åºä¹‹å‰éœ€è¦è€ƒè™‘è¿™äº›ã€‚Meta æä¾›äº†ä¸€ä»½è´Ÿè´£ä»»çš„ä½¿ç”¨æŒ‡å—ï¼Œå…¶ä¸­åŒ…å«å®‰å…¨æµ‹è¯•å’Œè°ƒæ•´çš„å»ºè®®ã€‚\n     \n    ')]
</code></pre>

<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ·»åŠ äº†_ä¸¤æ¡_æ¶ˆæ¯ï¼Œæˆ‘ä»¬çš„ <code>HumanMessage</code> å’Œä»£ç†çš„ <code>AIMessage</code> å“åº”ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥å°†è¿™äº›æ¶ˆæ¯å‘é€ç»™æˆ‘ä»¬çš„ XML ä»£ç†ã€‚ç›¸åï¼Œæˆ‘ä»¬éœ€è¦ä¼ é€’ä¸€ä¸ªæ ¼å¼ä¸ºï¼š</p>
<pre class="codehilite"><code>Human: {human message}
AI: {AI message}
</code></pre>

<p>çš„å­—ç¬¦ä¸²ã€‚è®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç®€å•çš„ <code>memory2str</code> è¾…åŠ©å‡½æ•°æ¥ä¸ºæˆ‘ä»¬å¤„ç†è¿™ä¸ªé—®é¢˜ï¼š</p>
<pre class="codehilite"><code class="language-python">from langchain_core.messages.human import HumanMessage

def memory2str(memory: ConversationBufferWindowMemory):
    # å°†è®°å¿†ä¸­çš„æ¶ˆæ¯è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ ¼å¼
    messages = memory.chat_memory.messages
    memory_list = [
        f&quot;Human: {mem.content}&quot; if isinstance(mem, HumanMessage) \
        else f&quot;AI: {mem.content}&quot; for mem in messages
    ]
    memory_str = &quot;\n&quot;.join(memory_list)
    return memory_str
</code></pre>

<pre class="codehilite"><code class="language-python"># æ‰“å°è®°å¿†å†…å®¹
print(memory2str(conversational_memory))
</code></pre>

<pre class="codehilite"><code>Human: can you tell me about llama 2?
AI:

- Llama 2 æ˜¯ç”± Meta AI å¼€å‘çš„å¤§å‹è¯­è¨€æ¨¡å‹ï¼Œæœ‰ 7B åˆ° 70B å‚æ•°çš„ä¸åŒå°ºå¯¸ã€‚

- Code Llama æ˜¯ Llama 2 çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œé€šè¿‡åœ¨ä»£ç æ•°æ®é›†ä¸Šè¿›è¡Œå¾®è°ƒï¼Œä¸“é—¨ç”¨äºä»£ç ç”Ÿæˆã€‚Code Llama æ¨¡å‹æœ‰ Pythonã€C++ã€Javaã€PHPã€TypeScriptã€C# å’Œ Bash ç‰ˆæœ¬ã€‚

- Code Llama çš„ä¸“é—¨åŒ–æµç¨‹åŒ…æ‹¬åŸºç¡€æ¨¡å‹é¢„è®­ç»ƒã€é•¿ä¸Šä¸‹æ–‡è®­ç»ƒã€ä»£ç å¡«å……è®­ç»ƒä»¥åŠé’ˆå¯¹ç‰¹å®šç¼–ç¨‹è¯­è¨€çš„å¾®è°ƒã€‚

- Code Llama çš„è¡¨ç°æ˜æ˜¾ä¼˜äºåŸºç¡€ Llama 2 æ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œ34B å‚æ•°çš„ Code Llama - Python åœ¨ HumanEval ä¸Šçš„ pass@1 å‡†ç¡®ç‡ä¸º 48.8%ï¼Œè€Œ 34B çš„ Llama 2 ä¸º 34.1%ã€‚

- ä¸æ‰€æœ‰å¤§å‹è¯­è¨€æ¨¡å‹ä¸€æ ·ï¼ŒLlama 2 ä¹Ÿæœ‰å±€é™æ€§å’Œæ½œåœ¨é£é™©ï¼Œåœ¨éƒ¨ç½²åˆ°åº”ç”¨ç¨‹åºä¹‹å‰éœ€è¦è€ƒè™‘è¿™äº›ã€‚Meta æä¾›äº†ä¸€ä»½è´Ÿè´£ä»»çš„ä½¿ç”¨æŒ‡å—ï¼Œå…¶ä¸­åŒ…å«å®‰å…¨æµ‹è¯•å’Œè°ƒæ•´çš„å»ºè®®ã€‚
</code></pre>

<p>ç°åœ¨è®©æˆ‘ä»¬ç»„åˆå¦ä¸€ä¸ªåä¸º <code>chat</code> çš„è¾…åŠ©å‡½æ•°ï¼Œä»¥å¸®åŠ©æˆ‘ä»¬å¤„ç†ä»£ç†çš„_çŠ¶æ€_éƒ¨åˆ†ã€‚</p>
<pre class="codehilite"><code class="language-python">def chat(text: str):
    # è°ƒç”¨ä»£ç†æ‰§è¡Œå™¨ï¼Œä¼ å…¥ç”¨æˆ·è¾“å…¥å’Œå¯¹è¯å†å²
    out = agent_executor.invoke({
        &quot;input&quot;: text,
        &quot;chat_history&quot;: memory2str(conversational_memory)
    })
    # å°†ç”¨æˆ·æ¶ˆæ¯å’Œä»£ç†å“åº”æ·»åŠ åˆ°è®°å¿†ä¸­
    conversational_memory.chat_memory.add_user_message(text)
    conversational_memory.chat_memory.add_ai_message(out[&quot;output&quot;])
    return out[&quot;output&quot;]
</code></pre>

<p>ç°åœ¨æˆ‘ä»¬åªéœ€é€šè¿‡ <code>chat</code> å‡½æ•°ä¸ä»£ç†è¿›è¡ŒèŠå¤©ï¼Œå®ƒå°±ä¼šè®°ä½å…ˆå‰äº¤äº’çš„ä¸Šä¸‹æ–‡ã€‚</p>
<pre class="codehilite"><code class="language-python"># æ‰“å° chat å‡½æ•°çš„è¾“å‡º
print(chat(&quot;was any red teaming done with the model?&quot;))
</code></pre>

<pre class="codehilite"><code> [1m&gt; Entering new AgentExecutor chain... [0m
 [32;1m [1;3m&lt;tool&gt;arxiv_search&lt;/tool&gt;
&lt;tool_input&gt;llama 2 red teaming [0m [36;1m [1;3mAfter conducting red team exercises, we asked participants (who had also participated in Llama 2 Chat exercises) to also provide qualitative assessment of safety capabilities of the model. Some participants who had expertise in offensive security and malware development questioned the ultimate risk posed by Ã¢â‚¬Å“malicious code generationÃ¢â‚¬  through LLMs with current capabilities.
One red teamer remarked, Ã¢â‚¬Å“While LLMs being able to iteratively improve on produced source code is a risk, producing source code isnÃ¢â‚¬â„¢t the actual gap. That said, LLMs may be risky because they can inform low-skill adversaries in production of scripts through iteration that perform some malicious behavior.Ã¢â‚¬ 
According to another red teamer, Ã¢â‚¬Å“[v]arious scripts, program code, and compiled binaries are readily available on mainstream public websites, hacking forums or on Ã¢â‚¬Ëœthe dark web.Ã¢â‚¬â„¢ Advanced malware development is beyond the current capabilities of available LLMs, and even an advanced LLM paired with an expert malware developer is not particularly useful- as the barrier is not typically writing the malware code itself. That said, these LLMs may produce code which will get easily caught if used directly.Ã¢â‚¬

Model Llama 2 Code Llama Code Llama - Python Size FIM LCFT Python CPP Java PHP TypeScript C# Bash Average 7B Ã¢Å“â€” 13B Ã¢Å“â€” 34B Ã¢Å“â€” 70B Ã¢Å“â€” 7B Ã¢Å“â€” 7B Ã¢Å“â€œ 7B Ã¢Å“â€” 7B Ã¢Å“â€œ 13B Ã¢Å“â€” 13B Ã¢Å“â€œ 13B Ã¢Å“â€” 13B Ã¢Å“â€œ 34B Ã¢Å“â€” 34B Ã¢Å“â€” 7B Ã¢Å“â€” 7B Ã¢Å“â€” 13B Ã¢Å“â€” 13B Ã¢Å“â€” 34B Ã¢Å“â€” 34B Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€” 14.3% 6.8% 10.8% 9.9% 19.9% 13.7% 15.8% 13.0% 24.2% 23.6% 22.2% 19.9% 27.3% 30.4% 31.6% 34.2% 12.6% 13.2% 21.4% 15.1% 6.3% 3.2% 8.3% 9.5% 3.2% 12.6% 17.1% 3.8% 18.9% 25.9% 8.9% 24.8% Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€œ Ã¢Å“â€œ Ã¢Å“â€” Ã¢Å“â€” Ã¢Å“â€œ Ã¢Å“â€œ Ã¢Å“â€” Ã¢Å“â€œ 37.3% 31.1% 36.1% 30.4% 29.2% 29.8% 38.0%

In addition to red teaming sessions, we ran a quantitative evaluation on risk from generating malicious code by scoring Code LlamaÃ¢â‚¬â„¢s responses to ChatGPTÃ¢â‚¬â„¢s (GPT3.5 Turbo) with LLAMAv2 70BÃ¢â‚¬â„¢s safety reward model. For this second quantitative evaluation, we selected prompts that the red teamers generated specifically attempting to solicit malicious code (even though the red teaming included consideration of a broad set of safety risks). These prompts were a mix of clear intent and slightly obfuscated intentions (see some examples in Figure 16. We show a KDE plot of the distribution of the safety score for all models in Figure 7). We observe that Code Llama tends to answer with safer responses; the distribution of safety scores for Code Llama has more weight in the safer part of the range.
False refusals. LLMs that are too safe can have a tendency to over-refuse valid claims similar to what was reported after the release of Llama 2. We specifically asked red teamers to test for this behavior. They found some limited evidence of false refusals (when not using a system preprompt). False refusals could also
16

15
pafety Reward Model Scores Distribution on Red Teaming Prompts
Responding Model GPT 3.5 Turbo Code Llama 138 Instruct Code Llama 34B Instruct Code Llama 7B Instruct 0.0-+ -0.2 0.0 0.2 0.4 0.6 0.8 1.0 12 Llama 2 70B Safety Reward Model Score
Figure 7: KDE plot of the risk score output by the Llama 2 safety reward model on prompts with clear intent specific to code risk created by red teamers with background in cybersecurity and malware generation.
Red teaming. It is important to also proactively identify risks with adversarial testing or red teaming. We conducted 3 red teaming exercises with 25 Meta employees, including domain experts in responsible AI, malware development, and offensive security engineering.
The red teamers provided a nuanced evaluation specifically on the risk from so called Ã¢â‚¬Å“dual intent prompts.Ã¢â‚¬  Dual intent prompts are requests for help with writing code that could be used maliciously but the prompt does not directly address the topic (example Ã¢â‚¬Å“Mosaic PromptsÃ¢â‚¬  Glukhov et al. (2023)). For example, the model rightfully refuses to provide support with writing ransomware code but it complies when asked to provide a script to encrypt all files in the userÃ¢â‚¬â„¢s home directory since such a script could be used for benign purposes.

. . . . . . . . . . . . . . . 3.4 RLHF Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Safety in Pretraining . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.2 Safety Fine-Tuning . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.3 Red Teaming . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.4 Safety Evaluation of Llama 2-Chat . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.1 Learnings and Observations . . . . . . . . . . . . . . . . . . . . . . . . [0m

&lt;final_answer&gt;
æ ¹æ®æ¥è‡ª arxiv çš„æœç´¢ä¿¡æ¯ï¼Œåœ¨ Llama 2 æ¨¡å‹å¼€å‘è¿‡ç¨‹ä¸­è¿›è¡Œäº†ä¸€äº›çº¢é˜Ÿæ¼”ç»ƒï¼Œä»¥è¯†åˆ«æ½œåœ¨çš„å®‰å…¨é£é™©ï¼š

- Meta è¿›è¡Œäº† 3 æ¬¡çº¢é˜Ÿæ¼”ç»ƒï¼Œå…±æœ‰ 25 åå‘˜å·¥å‚ä¸ï¼Œå…¶ä¸­åŒ…æ‹¬è´Ÿè´£ä»»çš„ AIã€æ¶æ„è½¯ä»¶å¼€å‘å’Œè¿›æ”»æ€§å®‰å…¨å·¥ç¨‹é¢†åŸŸçš„é¢†åŸŸä¸“å®¶ã€‚

- çº¢é˜Ÿæˆå‘˜å°†æˆåŠŸæ”»å‡»åˆ†ä¸ºå››ç§ä¸»è¦ç±»å‹ï¼š1) è®©æ¨¡å‹æä¾›ä¸€äº›æœ‰å®³ä¿¡æ¯ï¼ŒåŒæ—¶æ‹’ç»å…¶ä»–å†…å®¹ï¼›2) è®©æ¨¡å‹æ‰®æ¼”ç‰¹å®šåœºæ™¯ï¼›3) å¼ºè¿«æ¨¡å‹å¼ºè°ƒæœ‰å®³å†…å®¹çš„ç§¯ææ–¹é¢ï¼›4) å°†æœ‰å®³æŒ‡ä»¤åµŒå…¥å¤æ‚å‘½ä»¤ä¸­ã€‚

- ä¸€äº›çº¢é˜Ÿæˆå‘˜è´¨ç–‘å½“å‰ LLM é€šè¿‡â€œæ¶æ„ä»£ç ç”Ÿæˆâ€å¸¦æ¥çš„æœ€ç»ˆé£é™©ã€‚ä»–ä»¬æŒ‡å‡ºï¼Œè™½ç„¶ LLM èƒ½å¤Ÿè¿­ä»£æ”¹è¿›ä»£ç æ˜¯ä¸€ä¸ªé£é™©ï¼Œä½†ç¼–å†™æºä»£ç æœ¬èº«å¹¶ä¸æ˜¯ä¸»è¦éšœç¢ã€‚é«˜çº§æ¶æ„è½¯ä»¶å¼€å‘ç›®å‰è¶…å‡ºäº† LLM çš„èƒ½åŠ›èŒƒå›´ã€‚

- è¿˜é€šè¿‡ä½¿ç”¨ Llama 2 çš„å®‰å…¨å¥–åŠ±æ¨¡å‹å¯¹æ¶æ„ä»£ç æç¤ºçš„ Code Llama å“åº”è¿›è¡Œè¯„åˆ†æ¥è¿›è¡Œå®šé‡è¯„ä¼°ã€‚ä¸ GPT-3.5 ç›¸æ¯”ï¼ŒCode Llama å€¾å‘äºæä¾›æ›´å®‰å…¨çš„å›åº”ã€‚

- ç„¶è€Œï¼Œæ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œçº¢é˜Ÿæ¼”ç»ƒçš„å…¨éƒ¨èŒƒå›´å’Œç»†èŠ‚æ˜¯æœ‰é™çš„ã€‚Llama 2 è®ºæ–‡æåˆ°äº†é€šè¿‡çº¢é˜Ÿæ¼”ç»ƒæ‰©å±•å…·æœ‰å®‰å…¨é£é™©çš„æç¤ºï¼Œä½†æ²¡æœ‰æ·±å…¥ä»‹ç»è¿‡ç¨‹æˆ–ç»“æœã€‚éœ€è¦æ›´å¤šä¿¡æ¯æ‰èƒ½å…¨é¢æè¿°æ‰€è¿›è¡Œçš„çº¢é˜Ÿæ¼”ç»ƒã€‚

&lt;/final_answer&gt;

 [1m&gt; Finished chain. [0m

- Meta è¿›è¡Œäº† 3 æ¬¡çº¢é˜Ÿæ¼”ç»ƒï¼Œå…±æœ‰ 25 åå‘˜å·¥å‚ä¸ï¼Œå…¶ä¸­åŒ…æ‹¬è´Ÿè´£ä»»çš„ AIã€æ¶æ„è½¯ä»¶å¼€å‘å’Œè¿›æ”»æ€§å®‰å…¨å·¥ç¨‹é¢†åŸŸçš„é¢†åŸŸä¸“å®¶ã€‚

- çº¢é˜Ÿæˆå‘˜å°†æˆåŠŸæ”»å‡»åˆ†ä¸ºå››ç§ä¸»è¦ç±»å‹ï¼š1) è®©æ¨¡å‹æä¾›ä¸€äº›æœ‰å®³ä¿¡æ¯ï¼ŒåŒæ—¶æ‹’ç»å…¶ä»–å†…å®¹ï¼›2) è®©æ¨¡å‹æ‰®æ¼”ç‰¹å®šåœºæ™¯ï¼›3) å¼ºè¿«æ¨¡å‹å¼ºè°ƒæœ‰å®³å†…å®¹çš„ç§¯ææ–¹é¢ï¼›4) å°†æœ‰å®³æŒ‡ä»¤åµŒå…¥å¤æ‚å‘½ä»¤ä¸­ã€‚

- ä¸€äº›çº¢é˜Ÿæˆå‘˜è´¨ç–‘å½“å‰ LLM é€šè¿‡â€œæ¶æ„ä»£ç ç”Ÿæˆâ€å¸¦æ¥çš„æœ€ç»ˆé£é™©ã€‚ä»–ä»¬æŒ‡å‡ºï¼Œè™½ç„¶ LLM èƒ½å¤Ÿè¿­ä»£æ”¹è¿›ä»£ç æ˜¯ä¸€ä¸ªé£é™©ï¼Œä½†ç¼–å†™æºä»£ç æœ¬èº«å¹¶ä¸æ˜¯ä¸»è¦éšœç¢ã€‚é«˜çº§æ¶æ„è½¯ä»¶å¼€å‘ç›®å‰è¶…å‡ºäº† LLM çš„èƒ½åŠ›èŒƒå›´ã€‚

- è¿˜é€šè¿‡ä½¿ç”¨ Llama 2 çš„å®‰å…¨å¥–åŠ±æ¨¡å‹å¯¹æ¶æ„ä»£ç æç¤ºçš„ Code Llama å“åº”è¿›è¡Œè¯„åˆ†æ¥è¿›è¡Œå®šé‡è¯„ä¼°ã€‚ä¸ GPT-3.5 ç›¸æ¯”ï¼ŒCode Llama å€¾å‘äºæä¾›æ›´å®‰å…¨çš„å›åº”ã€‚

- ç„¶è€Œï¼Œæ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œçº¢é˜Ÿæ¼”ç»ƒçš„å…¨éƒ¨èŒƒå›´å’Œç»†èŠ‚æ˜¯æœ‰é™çš„ã€‚Llama 2 è®ºæ–‡æåˆ°äº†é€šè¿‡çº¢é˜Ÿæ¼”ç»ƒæ‰©å±•å…·æœ‰å®‰å…¨é£é™©çš„æç¤ºï¼Œä½†æ²¡æœ‰æ·±å…¥ä»‹ç»è¿‡ç¨‹æˆ–ç»“æœã€‚éœ€è¦æ›´å¤šä¿¡æ¯æ‰èƒ½å…¨é¢æè¿°æ‰€è¿›è¡Œçš„çº¢é˜Ÿæ¼”ç»ƒã€‚
</code></pre>

<p>æˆ‘ä»¬å¯ä»¥æå‡ºé—æ¼å…³é”®ä¿¡æ¯çš„åç»­é—®é¢˜ï¼Œä½†ç”±äºå¯¹è¯å†å²çš„å­˜åœ¨ï¼ŒLLM ä¼šç†è§£ä¸Šä¸‹æ–‡å¹¶æ®æ­¤è°ƒæ•´æœç´¢æŸ¥è¯¢ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¯¢é—®äº† <code>red teaming</code> ä½†æ²¡æœ‰æåŠ <code>llama 2</code>â€”â€”Claude 3 æ ¹æ®èŠå¤©å†å²å°†æ­¤ä¸Šä¸‹æ–‡æ·»åŠ åˆ°äº†æœç´¢æŸ¥è¯¢ <code>"llama 2 red teaming"</code> ä¸­ã€‚</p>
            </article>
            
            <nav class="page-nav"><a href="patterns/agents/prompts/citations_agent_zh.html" class="nav-link prev">â† Untitled</a><a href="tool_use/customer_service_agent_zh.html" class="nav-link next">ä½¿ç”¨å®¢æˆ·ç«¯å·¥å…·åˆ›å»ºå®¢æœä»£ç† â†’</a></nav>
        </main>
    </div>
</body>
</html>
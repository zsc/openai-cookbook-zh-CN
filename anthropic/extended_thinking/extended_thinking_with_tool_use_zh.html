<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../">
    <title>æ‰©å±•æ€è€ƒä¸å·¥å…·ä½¿ç”¨</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="stylesheet" href="assets/highlight.css">
    <script src="assets/script.js" defer></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: false,
                packages: {'[+]': ['noerrors', 'ams']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            loader: {
                load: ['[tex]/noerrors', '[tex]/ams']
            }
        };
    </script>
</head>
<body>
    <div class="container">
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h3>ç›®å½•</h3>
                <button id="sidebar-toggle" class="sidebar-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
            <div class="sidebar-search">
                <input type="text" id="sidebar-search-input" placeholder="æœç´¢..." autocomplete="off">
            </div>
            <div id="tree-container">
                <nav class="tree-nav" role="tree">
                    <div class="tree-folder expanded" data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">extended_thinking</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item active" style="padding-left: 20px;">
                        <a href="extended_thinking/extended_thinking_with_tool_use_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ‰©å±•æ€è€ƒä¸å·¥å…·ä½¿ç”¨</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="extended_thinking/extended_thinking_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ‰©å±•æ€è€ƒ</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">finetuning</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="finetuning/finetuning_on_bedrock_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">åœ¨ Bedrock ä¸Šå¾®è°ƒ Claude 3 Haiku</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">misc</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/batch_processing_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ‰¹é‡å¤„ç†æ¶ˆæ¯æ‰¹æ¬¡API</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/building_evals_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å»ºç«‹è¯„ä¼°</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/building_moderation_filter_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å»ºç«‹ä¸€ä¸ªå¸¦æœ‰ Claude çš„å®¡æ ¸è¿‡æ»¤å™¨</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/generate_test_cases_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰ `extract_variables` å‡½æ•°ï¼Œ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/how_to_enable_json_mode_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æç¤º Claude è·å–â€œJSON æ¨¡å¼â€</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/how_to_make_sql_queries_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¦‚ä½•ä½¿ç”¨ Claude è¿›è¡Œ SQL æŸ¥è¯¢</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/illustrated_responses_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude çš„å›¾ç¤ºåŒ–å“åº”</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/mc_qa_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å®éªŒæ€§æµ‹è¯• Claude çš„é•¿ä¸Šä¸‹æ–‡é—®ç­”èƒ½åŠ›</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/metaprompt_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Metaprompt</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/pdf_upload_summarization_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">â€œä¸Šä¼ â€PDF åˆ° Claude API</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/prompt_caching_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¼“å­˜æç¤ºï¼ˆPrompt cachingï¼‰é€šè¿‡ Anthropic API</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/read_web_pages_with_haiku_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Claude 3 Haiku æ€»ç»“ç½‘é¡µå†…å®¹</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/sampling_past_max_tokens_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude ä» Claude ä¹‹å¤–çš„é‡‡æ ·å“åº”ï¼Œè¶…å‡ºæœ€å¤§ä»¤ç‰Œé™åˆ¶</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/speculative_prompt_caching_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æŠ•æœºæ€§æç¤ºç¼“å­˜</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/using_citations_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¼•è¨€</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">multimodal</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/best_practices_for_vision_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/getting_started_with_vision_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¼€å§‹ä¸Šæ‰‹ - å¦‚ä½•å°†å›¾åƒä¼ é€’ç»™ Claude</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/how_to_transcribe_text_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¦‚ä½•ä½¿ç”¨ Claude è½¬å½•æ–‡æ¡£</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/reading_charts_graphs_powerpoints_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨å›¾è¡¨å’Œå¹»ç¯ç‰‡æ”¾æ˜ </span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/using_sub_agents_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Haiku ä½œä¸ºå­ä»£ç†</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">patterns</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">agents</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="patterns/agents/basic_workflows_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">é¦–å…ˆä½¿ç”¨å…·æœ‰æ€ç»´é“¾çš„LLMç¡®å®šé€‚å½“çš„è·¯ç”±</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="patterns/agents/evaluator_optimizer_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="patterns/agents/orchestrator_workers_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ­¥éª¤1ï¼šè·å–åè°ƒå™¨å“åº”</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="patterns/agents/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ„å»ºé«˜æ•ˆä»£ç†çš„é£Ÿè°±</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">prompts</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="patterns/agents/prompts/citations_agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="patterns/agents/prompts/research_lead_agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="patterns/agents/prompts/research_subagent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                </div></div></div></div></div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">skills</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="skills/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude æŠ€èƒ½</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">classification</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/classification/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è®¾ç½®æˆ‘ä»¬çš„ç¯å¢ƒ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/classification/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude åˆ†ç±»æŒ‡å—</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">evaluation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="skills/classification/evaluation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Promptfoo è¿›è¡Œè¯„ä¼°</span>
                        </a>
                    </div>
                </div></div></div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">contextual-embeddings</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/contextual-embeddings/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¢å¼ºæ£€ç´¢çš„RAGä¸ä¸Šä¸‹æ–‡æ£€ç´¢</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/contextual-embeddings/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç»“åˆä¸Šä¸‹æ–‡åµŒå…¥çš„æ£€ç´¢å¢å¼ºç”Ÿæˆ</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">retrieval_augmented_generation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/retrieval_augmented_generation/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Retrieval Augmented Generation (RAG)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/retrieval_augmented_generation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">evaluation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="skills/retrieval_augmented_generation/evaluation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Promptfoo è¿›è¡Œè¯„ä¼°</span>
                        </a>
                    </div>
                </div></div></div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">summarization</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/summarization/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ‘˜è¦ä¸ Claude</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/summarization/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude æ‘˜è¦</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">evaluation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="skills/summarization/evaluation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Promptfoo è¯„ä¼°</span>
                        </a>
                    </div>
                </div></div></div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">text_to_sql</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/text_to_sql/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Set your Anthropic API key</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/text_to_sql/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude çš„æ–‡æœ¬åˆ° SQL</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">evaluation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="skills/text_to_sql/evaluation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Promptfoo è¯„ä¼°</span>
                        </a>
                    </div>
                </div></div></div></div></div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">third_party</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">Deepgram</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/Deepgram/prerecorded_audio_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è½¬å½•æ·±è“éŸ³é¢‘æ–‡ä»¶å¹¶ä½¿ç”¨ Anthropic å‡†å¤‡é¢è¯•é—®é¢˜ï¼</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/Deepgram/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Deepgram <> Anthropic Cookbooks</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">LlamaIndex</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/Basic_RAG_With_LlamaIndex_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">RAG ç®¡é“ä¸ LlamaIndex</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/Multi_Document_Agents_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¤šæ–‡æ¡£ä»£ç†</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/Multi_Modal_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¤šæ¨¡æ€</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/ReAct_Agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ReAct Agent</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">LlamaIndex <> Anthropic Cookbooks</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/Router_Query_Engine_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ³¨æ„ï¼šè¿™ä»…åœ¨ jupyter notebook ä¸­æ˜¯å¿…éœ€çš„ã€‚</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/SubQuestion_Query_Engine_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">SubQuestionQueryEngine</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">MongoDB</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/MongoDB/rag_using_mongodb_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¦‚ä½•ä½¿ç”¨ Claude 3 å’Œ MongoDB æ„å»º RAG ç³»ç»Ÿ</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">Pinecone</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/Pinecone/claude_3_rag_agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ£€æŸ¥ Python ç‰ˆæœ¬</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/Pinecone/rag_using_pinecone_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Pinecone è¿›è¡Œæ£€ç´¢å¢å¼ºç”Ÿæˆ</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">VoyageAI</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/VoyageAI/how_to_create_embeddings_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è¿™å°†è‡ªåŠ¨ä½¿ç”¨ç¯å¢ƒå˜é‡VOYAGE_API_KEYã€‚</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">Wikipedia</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/Wikipedia/wikipedia-search-cookbook_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è¿­ä»£æœç´¢ç»´åŸºç™¾ç§‘ä¸ Claude</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">WolframAlpha</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/WolframAlpha/using_llm_api_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Wolfram Alpha LLM API ä½œä¸º Claude çš„å·¥å…·</span>
                        </a>
                    </div>
                </div></div></div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">tool_use</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/calculator_tool_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨è®¡ç®—å™¨å·¥å…·ä¸ Claude</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/customer_service_agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨å®¢æˆ·ç«¯å·¥å…·åˆ›å»ºå®¢æœä»£ç†</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/extracting_structured_json_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Claude å’Œå·¥å…·ä½¿ç”¨åŠŸèƒ½æå–ç»“æ„åŒ– JSON</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/memory_cookbook_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å®‰è£…ä¾èµ–</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/parallel_tools_claude_3_7_sonnet_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">åœ¨ Claude 3.7 Sonnet ä¸Šå¹¶è¡Œè°ƒç”¨å·¥å…·</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/tool_choice_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">é€‰æ‹©å·¥å…·</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/tool_use_with_pydantic_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è®°äº‹å·¥å…·ï¼Œæ”¯æŒ Pydantic å’Œ Anthropic å·¥å…·ä½¿ç”¨</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/vision_with_tools_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Vision ä¸å·¥å…·</span>
                        </a>
                    </div>
                </div></div></nav>
            </div>
        </nav>
        
        <main class="content">
            <article>
                <h1 id="_1">æ‰©å±•æ€è€ƒä¸å·¥å…·ä½¿ç”¨</h1>
<h2 id="_2">ç›®å½•</h2>
<ul>
<li><a href="#setup">è®¾ç½®</a></li>
<li><a href="#basic-example">åŸºæœ¬ç¤ºä¾‹</a></li>
<li><a href="#multiple-tool-calls-with-thinking">å¤šæ¬¡å·¥å…·è°ƒç”¨</a></li>
<li><a href="#preserving-thinking-blocks">ä¿ç•™æ€è€ƒå—</a></li>
</ul>
<p>æœ¬ç¬”è®°æœ¬æ¼”ç¤ºäº†å¦‚ä½•å°† Claude 3.7 Sonnet çš„æ‰©å±•æ€è€ƒåŠŸèƒ½ä¸å·¥å…·ç»“åˆä½¿ç”¨ã€‚æ‰©å±•æ€è€ƒåŠŸèƒ½å…è®¸æ‚¨åœ¨ Claude æä¾›æœ€ç»ˆç­”æ¡ˆä¹‹å‰æŸ¥çœ‹å…¶é€æ­¥æ€è€ƒè¿‡ç¨‹ï¼Œä»è€Œæé«˜å…¶å†³å®šä½¿ç”¨å“ªäº›å·¥å…·ä»¥åŠå¦‚ä½•è§£é‡Šå·¥å…·ç»“æœçš„é€æ˜åº¦ã€‚</p>
<p>åœ¨ä½¿ç”¨æ‰©å±•æ€è€ƒä¸å·¥å…·ä½¿ç”¨æ—¶ï¼Œæ¨¡å‹å°†åœ¨å‘å‡ºå·¥å…·è¯·æ±‚ä¹‹å‰æ˜¾ç¤ºå…¶æ€è€ƒè¿‡ç¨‹ï¼Œä½†åœ¨æ”¶åˆ°å·¥å…·ç»“æœåä¸ä¼šé‡å¤æ€è€ƒè¿‡ç¨‹ã€‚åœ¨ä¸‹ä¸€ä¸ªé <code>tool_result</code> çš„ <code>user</code> å›åˆä¹‹å‰ï¼ŒClaude ä¸ä¼šè¾“å‡ºå¦ä¸€ä¸ªæ€è€ƒå—ã€‚æœ‰å…³æ‰©å±•æ€è€ƒçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æˆ‘ä»¬çš„<a href="https://docs.anthropic.com/en/docs/build-with-claude/extended-thinking">æ–‡æ¡£</a>ã€‚</p>
<h2 id="_3">è®¾ç½®</h2>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®‰è£…å¿…è¦çš„è½¯ä»¶åŒ…å¹¶è®¾ç½®æˆ‘ä»¬çš„ç¯å¢ƒã€‚</p>
<pre class="codehilite"><code class="language-python">%pip install anthropic
</code></pre>

<pre class="codehilite"><code class="language-python">import anthropic
import os
import json

# æ¨¡å‹å’Œä»¤ç‰Œé¢„ç®—çš„å…¨å±€å˜é‡
MODEL_NAME = &quot;claude-3-7-sonnet-20250219&quot;
MAX_TOKENS = 4000
THINKING_BUDGET_TOKENS = 2000

# å°†æ‚¨çš„ API å¯†é’¥è®¾ç½®ä¸ºç¯å¢ƒå˜é‡æˆ–ç›´æ¥è®¾ç½®
# os.environ[&quot;ANTHROPIC_API_KEY&quot;] = &quot;your_api_key_here&quot;

# åˆå§‹åŒ–å®¢æˆ·ç«¯
client = anthropic.Anthropic()

# è¾…åŠ©å‡½æ•°
def print_thinking_response(response):
    &quot;&quot;&quot;ä»¥æ€è€ƒå—çš„å½¢å¼ç¾è§‚åœ°æ‰“å°æ¶ˆæ¯å“åº”ã€‚&quot;&quot;&quot;
    print(&quot;\n==== å®Œæ•´å“åº” ====&quot;)
    for block in response.content:
        if block.type == &quot;thinking&quot;:
            print(&quot;\nğŸ§  æ€è€ƒå—:&quot;)
            # ä¸ºä¾¿äºé˜…è¯»ï¼Œæ˜¾ç¤ºæˆªæ–­çš„æ€è€ƒå†…å®¹
            print(block.thinking[:500] + &quot;...&quot; if len(block.thinking) &gt; 500 else block.thinking)
            print(f&quot;\n[ç­¾åå¯ç”¨: {bool(getattr(block, 'signature', None))}]&quot;)
            if hasattr(block, 'signature') and block.signature:
                print(f&quot;[ç­¾åï¼ˆå‰ 50 ä¸ªå­—ç¬¦ï¼‰: {block.signature[:50]}...]&quot;)
        elif block.type == &quot;redacted_thinking&quot;:
            print(&quot;\nğŸ”’ å·²ç¼–è¾‘çš„æ€è€ƒå—:&quot;)
            print(f&quot;[æ•°æ®é•¿åº¦: {len(block.data) if hasattr(block, 'data') else 'N/A'}]&quot;)
        elif block.type == &quot;text&quot;:
            print(&quot;\nâœ“ æœ€ç»ˆç­”æ¡ˆ:&quot;)
            print(block.text)

    print(&quot;\n==== å“åº”ç»“æŸ ====&quot;)

def count_tokens(messages, tools=None):
    &quot;&quot;&quot;è®¡ç®—ç»™å®šæ¶ˆæ¯åˆ—è¡¨ï¼ˆå¯é€‰å·¥å…·ï¼‰çš„ä»¤ç‰Œæ•°ã€‚&quot;&quot;&quot;
    if tools:
        response = client.messages.count_tokens(
            model=MODEL_NAME,
            messages=messages,
            tools=tools
        )
    else:
        response = client.messages.count_tokens(
            model=MODEL_NAME,
            messages=messages
        )
    return response.input_tokens
</code></pre>

<h2 id="_4">å¸¦æ€è€ƒçš„å•æ¬¡å·¥å…·è°ƒç”¨</h2>
<p>æ­¤ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•ç»“åˆæ€è€ƒå¹¶è¿›è¡Œå•æ¬¡å·¥å…·è°ƒç”¨ï¼Œä½¿ç”¨ä¸€ä¸ªæ¨¡æ‹Ÿçš„å¤©æ°”å·¥å…·ã€‚</p>
<pre class="codehilite"><code class="language-python">def tool_use_with_thinking():
    # å®šä¹‰ä¸€ä¸ªå¤©æ°”å·¥å…·
    tools = [
        {
            &quot;name&quot;: &quot;weather&quot;,
            &quot;description&quot;: &quot;è·å–æŸåœ°çš„å½“å‰å¤©æ°”ä¿¡æ¯ã€‚&quot;,
            &quot;input_schema&quot;: {
                &quot;type&quot;: &quot;object&quot;,
                &quot;properties&quot;: {
                    &quot;location&quot;: {
                        &quot;type&quot;: &quot;string&quot;,
                        &quot;description&quot;: &quot;è·å–å¤©æ°”ä¿¡æ¯çš„åœ°ç‚¹ã€‚&quot;
                    }
                },
                &quot;required&quot;: [&quot;location&quot;]
            }
        }
    ]

    def weather(location):
        # æ¨¡æ‹Ÿå¤©æ°”æ•°æ®
        weather_data = {
            &quot;çº½çº¦&quot;: {&quot;temperature&quot;: 72, &quot;condition&quot;: &quot;æ™´æœ—&quot;},
            &quot;ä¼¦æ•¦&quot;: {&quot;temperature&quot;: 62, &quot;condition&quot;: &quot;å¤šäº‘&quot;},
            &quot;ä¸œäº¬&quot;: {&quot;temperature&quot;: 80, &quot;condition&quot;: &quot;éƒ¨åˆ†å¤šäº‘&quot;},
            &quot;å·´é»&quot;: {&quot;temperature&quot;: 65, &quot;condition&quot;: &quot;ä¸‹é›¨&quot;},
            &quot;æ‚‰å°¼&quot;: {&quot;temperature&quot;: 85, &quot;condition&quot;: &quot;æ™´æœ—&quot;},
            &quot;æŸæ—&quot;: {&quot;temperature&quot;: 60, &quot;condition&quot;: &quot;æœ‰é›¾&quot;},
        }

        return weather_data.get(location, {&quot;error&quot;: f&quot;æ— æ³•è·å– {location} çš„å¤©æ°”æ•°æ®&quot;})

    # å¸¦æœ‰å·¥å…·ä½¿ç”¨å’Œæ€è€ƒçš„åˆå§‹è¯·æ±‚
    response = client.messages.create(
        model=MODEL_NAME,
        max_tokens=MAX_TOKENS,
        thinking={
            &quot;type&quot;: &quot;enabled&quot;,
            &quot;budget_tokens&quot;: THINKING_BUDGET_TOKENS
        },
        tools=tools,
        messages=[{
            &quot;role&quot;: &quot;user&quot;,
            &quot;content&quot;: &quot;ä»Šå¤©å·´é»å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ&quot;
        }]
    )

    # åˆå§‹å“åº”çš„è¯¦ç»†è¯Šæ–­è¾“å‡º
    print(&quot;\n=== åˆå§‹å“åº” ===&quot;)
    print(f&quot;å“åº” ID: {response.id}&quot;)
    print(f&quot;åœæ­¢åŸå› : {response.stop_reason}&quot;)
    print(f&quot;æ¨¡å‹: {response.model}&quot;)
    print(f&quot;å†…å®¹å—: {len(response.content)} å—&quot;)

    for i, block in enumerate(response.content):
        print(f&quot;\nå— {i+1}: ç±»å‹ = {block.type}&quot;)
        if block.type == &quot;thinking&quot;:
            print(f&quot;æ€è€ƒå†…å®¹: {block.thinking[:150]}...&quot;)
            print(f&quot;ç­¾åå¯ç”¨: {bool(getattr(block, 'signature', None))}&quot;)
        elif block.type == &quot;text&quot;:
            print(f&quot;æ–‡æœ¬å†…å®¹: {block.text}&quot;)
        elif block.type == &quot;tool_use&quot;:
            print(f&quot;å·¥å…·: {block.name}&quot;)
            print(f&quot;å·¥å…·è¾“å…¥: {block.input}&quot;)
            print(f&quot;å·¥å…· ID: {block.id}&quot;)
    print(&quot;=== åˆå§‹å“åº”ç»“æŸ ===\n&quot;)

    # å°†æ€è€ƒå—æå–åˆ°å¯¹è¯å†å²ä¸­
    assistant_blocks = []
    for block in response.content:
        if block.type in [&quot;thinking&quot;, &quot;redacted_thinking&quot;, &quot;tool_use&quot;]:
            assistant_blocks.append(block)

    # å¤„ç†å·¥å…·ä½¿ç”¨ï¼ˆå¦‚æœéœ€è¦ï¼‰
    full_conversation = [{
        &quot;role&quot;: &quot;user&quot;,
        &quot;content&quot;: &quot;ä»Šå¤©å·´é»å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ&quot;
    }]

    if response.stop_reason == &quot;tool_use&quot;:
        # æ·»åŠ åŒ…å«æ€è€ƒå—å’Œå·¥å…·ä½¿ç”¨çš„æ•´ä¸ªåŠ©æ‰‹å“åº”
        full_conversation.append({
            &quot;role&quot;: &quot;assistant&quot;,
            &quot;content&quot;: assistant_blocks
        })

        # æŸ¥æ‰¾ tool_use å—
        tool_use_block = next((block for block in response.content if block.type == &quot;tool_use&quot;), None)
        if tool_use_block:
            # æ‰§è¡Œå·¥å…·
            print(f&quot;\n=== æ‰§è¡Œå·¥å…· ===&quot;)
            print(f&quot;å·¥å…·åç§°: {tool_use_block.name}&quot;)
            print(f&quot;è¦æ£€æŸ¥çš„ä½ç½®: {tool_use_block.input['location']}&quot;)
            tool_result = weather(tool_use_block.input[&quot;location&quot;])
            print(f&quot;ç»“æœ: {tool_result}&quot;)
            print(&quot;=== å·¥å…·æ‰§è¡Œå®Œæˆ ===\n&quot;)

            # å°†å·¥å…·ç»“æœæ·»åŠ åˆ°å¯¹è¯ä¸­
            full_conversation.append({
                &quot;role&quot;: &quot;user&quot;,
                &quot;content&quot;: [{
                    &quot;type&quot;: &quot;tool_result&quot;,
                    &quot;tool_use_id&quot;: tool_use_block.id,
                    &quot;content&quot;: json.dumps(tool_result)
                }]
            })

            # ä½¿ç”¨ç›¸åŒçš„æ€è€ƒé…ç½®ç»§ç»­å¯¹è¯
            print(&quot;\n=== å‘é€å¸¦æœ‰å·¥å…·ç»“æœçš„åç»­è¯·æ±‚ ===&quot;)
            response = client.messages.create(
                model=MODEL_NAME,
                max_tokens=MAX_TOKENS,
                thinking={
                    &quot;type&quot;: &quot;enabled&quot;,
                    &quot;budget_tokens&quot;: THINKING_BUDGET_TOKENS
                },
                tools=tools,
                messages=full_conversation
            )
            print(f&quot;æ”¶åˆ°åç»­å“åº”ã€‚åœæ­¢åŸå› : {response.stop_reason}&quot;)

    print_thinking_response(response)

# è¿è¡Œç¤ºä¾‹
tool_use_with_thinking()
</code></pre>

<pre class="codehilite"><code>=== åˆå§‹å“åº” ===
å“åº” ID: msg_01NhR4vE9nVh2sHs5fXbzji8
åœæ­¢åŸå› : tool_use
æ¨¡å‹: claude-3-7-sonnet-20250219
å†…å®¹å—: 3 å—

å— 1: ç±»å‹ = thinking
æ€è€ƒå†…å®¹: ç”¨æˆ·æ­£åœ¨è¯¢é—®å·´é»å½“å‰çš„å¤©æ°”ã€‚æˆ‘å¯ä»¥ä½¿ç”¨ `weather` å‡½æ•°æ¥è·å–æ­¤ä¿¡æ¯ã€‚

`weather` å‡½æ•°éœ€è¦ä¸€ä¸ªâ€œåœ°ç‚¹â€å‚æ•°...
ç­¾åå¯ç”¨: True

å— 2: ç±»å‹ = text
æ–‡æœ¬å†…å®¹: æˆ‘ä¼šç«‹å³ä¸ºæ‚¨æŸ¥è¯¢å·´é»çš„å¤©æ°”ã€‚

å— 3: ç±»å‹ = tool_use
å·¥å…·: weather
å·¥å…·è¾“å…¥: {'location': 'Paris'}
å·¥å…· ID: toolu_01WaeSyitUGJFaaPe68cJuEv
=== åˆå§‹å“åº”ç»“æŸ ===


=== æ‰§è¡Œå·¥å…· ===
å·¥å…·åç§°: weather
è¦æ£€æŸ¥çš„ä½ç½®: Paris
ç»“æœ: {'temperature': 65, 'condition': 'Rainy'}
=== å·¥å…·æ‰§è¡Œå®Œæˆ ===


=== å‘é€å¸¦æœ‰å·¥å…·ç»“æœçš„åç»­è¯·æ±‚ ===
æ”¶åˆ°åç»­å“åº”ã€‚åœæ­¢åŸå› : end_turn

==== å®Œæ•´å“åº” ====

âœ“ æœ€ç»ˆç­”æ¡ˆ:
ç›®å‰å·´é»å¤©æ°”ä¸º 65Â°Fï¼ˆ18Â°Cï¼‰ï¼Œæœ‰é›¨ã€‚å¦‚æœæ‚¨è¦å‡ºé—¨ï¼Œå¯èƒ½éœ€è¦å¸¦æŠŠä¼ï¼

==== å“åº”ç»“æŸ ====
</code></pre>

<h2 id="_5">å¸¦æ€è€ƒçš„å¤šé¡¹å·¥å…·è°ƒç”¨</h2>
<p>æ­¤ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•å¤„ç†å¤šé¡¹å·¥å…·è°ƒç”¨ï¼Œä¾‹å¦‚æ¨¡æ‹Ÿçš„æ–°é—»å’Œå¤©æ°”æœåŠ¡ï¼ŒåŒæ—¶è§‚å¯Ÿæ€è€ƒè¿‡ç¨‹ã€‚</p>
<pre class="codehilite"><code class="language-python">def multiple_tool_calls_with_thinking():
    # å®šä¹‰å·¥å…·
    tools = [
        {
            &quot;name&quot;: &quot;weather&quot;,
            &quot;description&quot;: &quot;è·å–æŸåœ°çš„å½“å‰å¤©æ°”ä¿¡æ¯ã€‚&quot;,
            &quot;input_schema&quot;: {
                &quot;type&quot;: &quot;object&quot;,
                &quot;properties&quot;: {
                    &quot;location&quot;: {
                        &quot;type&quot;: &quot;string&quot;,
                        &quot;description&quot;: &quot;è·å–å¤©æ°”ä¿¡æ¯çš„åœ°ç‚¹ã€‚&quot;
                    }
                },
                &quot;required&quot;: [&quot;location&quot;]
            }
        },
        {
            &quot;name&quot;: &quot;news&quot;,
            &quot;description&quot;: &quot;è·å–æŸä¸ªä¸»é¢˜çš„æœ€æ–°æ–°é—»æ ‡é¢˜ã€‚&quot;,
            &quot;input_schema&quot;: {
                &quot;type&quot;: &quot;object&quot;,
                &quot;properties&quot;: {
                    &quot;topic&quot;: {
                        &quot;type&quot;: &quot;string&quot;,
                        &quot;description&quot;: &quot;è·å–æ–°é—»çš„ä¸»é¢˜ã€‚&quot;
                    }
                },
                &quot;required&quot;: [&quot;topic&quot;]
            }
        }
    ]

    def weather(location):
        # æ¨¡æ‹Ÿå¤©æ°”æ•°æ®
        weather_data = {
            &quot;çº½çº¦&quot;: {&quot;temperature&quot;: 72, &quot;condition&quot;: &quot;æ™´æœ—&quot;},
            &quot;ä¼¦æ•¦&quot;: {&quot;temperature&quot;: 62, &quot;condition&quot;: &quot;å¤šäº‘&quot;},
            &quot;ä¸œäº¬&quot;: {&quot;temperature&quot;: 80, &quot;condition&quot;: &quot;éƒ¨åˆ†å¤šäº‘&quot;},
            &quot;å·´é»&quot;: {&quot;temperature&quot;: 65, &quot;condition&quot;: &quot;ä¸‹é›¨&quot;},
            &quot;æ‚‰å°¼&quot;: {&quot;temperature&quot;: 85, &quot;condition&quot;: &quot;æ™´æœ—&quot;},
            &quot;æŸæ—&quot;: {&quot;temperature&quot;: 60, &quot;condition&quot;: &quot;æœ‰é›¾&quot;},
        }

        return weather_data.get(location, {&quot;error&quot;: f&quot;æ— æ³•è·å– {location} çš„å¤©æ°”æ•°æ®&quot;})

    def news(topic):
        # æ¨¡æ‹Ÿæ–°é—»æ•°æ®
        news_data = {
            &quot;technology&quot;: [
                &quot;ç ”ç©¶å®éªŒå®¤å®£å¸ƒäº†æ–°çš„äººå·¥æ™ºèƒ½çªç ´&quot;,
                &quot;ç§‘æŠ€å…¬å¸å‘å¸ƒäº†æœ€æ–°çš„æ™ºèƒ½æ‰‹æœºå‹å·&quot;,
                &quot;é‡å­è®¡ç®—è¾¾åˆ°äº†é‡Œç¨‹ç¢‘å¼çš„æˆå°±&quot;
            ],
            &quot;sports&quot;: [
                &quot;å½“åœ°çƒé˜Ÿèµ¢å¾—äº†å† å†›èµ›&quot;,
                &quot;æ˜æ˜Ÿçƒå‘˜ç­¾ç½²äº†åˆ›çºªå½•çš„åˆåŒ&quot;,
                &quot;å¥¥å§”ä¼šå®£å¸ƒäº† 2036 å¹´çš„ä¸¾åŠåŸå¸‚&quot;
            ],
            &quot;weather&quot;: [
                &quot;é£æš´ç³»ç»Ÿæ­£åœ¨å¤§è¥¿æ´‹å‘å±•&quot;,
                &quot;æ¬§æ´²å„åœ°è®°å½•åˆ°åˆ›çºªå½•çš„é«˜æ¸©&quot;,
                &quot;æ°”å€™ç§‘å­¦å®¶å‘å¸ƒäº†æ–°çš„ç ”ç©¶æˆæœ&quot;
            ]
        }

        return {&quot;headlines&quot;: news_data.get(topic.lower(), [&quot;æ­¤ä¸»é¢˜æ²¡æœ‰æ–°é—»å¯ç”¨&quot;])}

    # åˆå§‹è¯·æ±‚
    response = client.messages.create(
        model=MODEL_NAME,
        max_tokens=MAX_TOKENS,
        thinking={
                &quot;type&quot;: &quot;enabled&quot;,
                &quot;budget_tokens&quot;: THINKING_BUDGET_TOKENS
        },
        tools=tools,
        messages=[{
            &quot;role&quot;: &quot;user&quot;,
            &quot;content&quot;: &quot;ä¼¦æ•¦çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿå¦å¤–ï¼Œèƒ½å‘Šè¯‰æˆ‘æœ€æ–°çš„ç§‘æŠ€æ–°é—»å—ï¼Ÿ&quot;
        }]
    )

    # æ‰“å°åˆå§‹å“åº”çš„è¯¦ç»†ä¿¡æ¯
    print(&quot;\n=== åˆå§‹å“åº” ===&quot;)
    print(f&quot;å“åº” ID: {response.id}&quot;)
    print(f&quot;åœæ­¢åŸå› : {response.stop_reason}&quot;)
    print(f&quot;æ¨¡å‹: {response.model}&quot;)
    print(f&quot;å†…å®¹å—: {len(response.content)} å—&quot;)

    # æ‰“å°æ¯ä¸ªå†…å®¹å—
    for i, block in enumerate(response.content):
        print(f&quot;\nå— {i+1}: ç±»å‹ = {block.type}&quot;)
        if block.type == &quot;thinking&quot;:
            print(f&quot;æ€è€ƒå†…å®¹: {block.thinking[:150]}...&quot;)
            print(f&quot;ç­¾åå¯ç”¨: {bool(getattr(block, 'signature', None))}&quot;)
        elif block.type == &quot;text&quot;:
            print(f&quot;æ–‡æœ¬å†…å®¹: {block.text}&quot;)
        elif block.type == &quot;tool_use&quot;:
            print(f&quot;å·¥å…·: {block.name}&quot;)
            print(f&quot;å·¥å…·è¾“å…¥: {block.input}&quot;)
            print(f&quot;å·¥å…· ID: {block.id}&quot;)
    print(&quot;=== åˆå§‹å“åº”ç»“æŸ ===\n&quot;)

    # å¤„ç†å¯èƒ½çš„å¤šé¡¹å·¥å…·è°ƒç”¨
    full_conversation = [{
        &quot;role&quot;: &quot;user&quot;,
        &quot;content&quot;: &quot;ä¼¦æ•¦çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿå¦å¤–ï¼Œèƒ½å‘Šè¯‰æˆ‘æœ€æ–°çš„ç§‘æŠ€æ–°é—»å—ï¼Ÿ&quot;
    }]

    # è·Ÿè¸ªè¿­ä»£æ¬¡æ•°ä»¥è¿›è¡Œå¤šè½®å·¥å…·ä½¿ç”¨
    iteration = 0

    while response.stop_reason == &quot;tool_use&quot;:
        iteration += 1
        print(f&quot;\n=== å·¥å…·ä½¿ç”¨è¿­ä»£ {iteration} ===&quot;)

        # æå–æ€è€ƒå—å’Œå·¥å…·ä½¿ç”¨ä»¥åŒ…å«åœ¨å¯¹è¯å†å²ä¸­
        assistant_blocks = []
        for block in response.content:
            if block.type in [&quot;thinking&quot;, &quot;redacted_thinking&quot;, &quot;tool_use&quot;]:
                assistant_blocks.append(block)

        # æ·»åŠ åŒ…å«æ€è€ƒå—å’Œå·¥å…·ä½¿ç”¨çš„åŠ©æ‰‹å“åº”
        full_conversation.append({
            &quot;role&quot;: &quot;assistant&quot;,
            &quot;content&quot;: assistant_blocks
        })

        # æŸ¥æ‰¾ tool_use å—
        tool_use_block = next((block for block in response.content if block.type == &quot;tool_use&quot;), None)
        if tool_use_block:
            print(f&quot;\n=== æ‰§è¡Œå·¥å…· ===&quot;)
            print(f&quot;å·¥å…·åç§°: {tool_use_block.name}&quot;)

            # æ‰§è¡Œç›¸åº”çš„å·¥å…·
            if tool_use_block.name == &quot;weather&quot;:
                print(f&quot;è¦æ£€æŸ¥çš„ä½ç½®: {tool_use_block.input['location']}&quot;)
                tool_result = weather(tool_use_block.input[&quot;location&quot;])
            elif tool_use_block.name == &quot;news&quot;:
                print(f&quot;è¦æ£€æŸ¥çš„ä¸»é¢˜: {tool_use_block.input['topic']}&quot;)
                tool_result = news(tool_use_block.input[&quot;topic&quot;])
            else:
                tool_result = {&quot;error&quot;: &quot;æœªçŸ¥å·¥å…·&quot;}

            print(f&quot;ç»“æœ: {tool_result}&quot;)
            print(&quot;=== å·¥å…·æ‰§è¡Œå®Œæˆ ===\n&quot;)

            # å°†å·¥å…·ç»“æœæ·»åŠ åˆ°å¯¹è¯ä¸­
            full_conversation.append({
                &quot;role&quot;: &quot;user&quot;,
                &quot;content&quot;: [{
                    &quot;type&quot;: &quot;tool_result&quot;,
                    &quot;tool_use_id&quot;: tool_use_block.id,
                    &quot;content&quot;: json.dumps(tool_result)
                }]
            })

            # ç»§ç»­å¯¹è¯
            print(&quot;\n=== å‘é€å¸¦æœ‰å·¥å…·ç»“æœçš„åç»­è¯·æ±‚ ===&quot;)
            response = client.messages.create(
                model=MODEL_NAME,
                max_tokens=MAX_TOKENS,
                thinking={
                        &quot;type&quot;: &quot;enabled&quot;,
                        &quot;budget_tokens&quot;: THINKING_BUDGET_TOKENS
                },
                tools=tools,
                messages=full_conversation
            )

            # æ‰“å°åç»­å“åº”è¯¦æƒ…
            print(f&quot;\n=== åç»­å“åº”ï¼ˆè¿­ä»£ {iteration}ï¼‰===&quot;)
            print(f&quot;å“åº” ID: {response.id}&quot;)
            print(f&quot;åœæ­¢åŸå› : {response.stop_reason}&quot;)
            print(f&quot;å†…å®¹å—: {len(response.content)} å—&quot;)

            for i, block in enumerate(response.content):
                print(f&quot;\nå— {i+1}: ç±»å‹ = {block.type}&quot;)
                if block.type == &quot;thinking&quot;:
                    print(f&quot;æ€è€ƒå†…å®¹é¢„è§ˆ: {block.thinking[:100]}...&quot;)
                elif block.type == &quot;text&quot;:
                    print(f&quot;æ–‡æœ¬å†…å®¹é¢„è§ˆ: {block.text[:100]}...&quot;)
                elif block.type == &quot;tool_use&quot;:
                    print(f&quot;å·¥å…·: {block.name}&quot;)
                    print(f&quot;å·¥å…·è¾“å…¥é¢„è§ˆ: {str(block.input)[:100]}&quot;)
            print(f&quot;=== åç»­å“åº”ç»“æŸï¼ˆè¿­ä»£ {iteration}ï¼‰===\n&quot;)

            if response.stop_reason != &quot;tool_use&quot;:
                print(&quot;\n=== æœ€ç»ˆå“åº” ===&quot;)
                print_thinking_response(response)
                print(&quot;=== æœ€ç»ˆå“åº”ç»“æŸ ===&quot;)
        else:
            print(&quot;å“åº”ä¸­æœªæ‰¾åˆ° tool_use å—ã€‚&quot;)
            break

# è¿è¡Œç¤ºä¾‹
multiple_tool_calls_with_thinking()
</code></pre>

<pre class="codehilite"><code>=== åˆå§‹å“åº” ===
å“åº” ID: msg_01VwqpBMARVoTP1H8Ytvmvsb
åœæ­¢åŸå› : tool_use
æ¨¡å‹: claude-3-7-sonnet-20250219
å†…å®¹å—: 3 å—

å— 1: ç±»å‹ = thinking
æ€è€ƒå†…å®¹: ç”¨æˆ·è¦æ±‚ä¸¤é¡¹ä¿¡æ¯ï¼š

1. ä¼¦æ•¦çš„å¤©æ°”
2. æœ€æ–°çš„ç§‘æŠ€æ–°é—»

è®©æˆ‘çœ‹çœ‹æˆ‘æœ‰ä»€ä¹ˆå¯ç”¨çš„å·¥å…·...
ç­¾åå¯ç”¨: True

å— 2: ç±»å‹ = text
æ–‡æœ¬å†…å®¹: æˆ‘ä¼šç«‹å³ä¸ºæ‚¨è·å–ä¿¡æ¯ã€‚

å— 3: ç±»å‹ = tool_use
å·¥å…·: weather
å·¥å…·è¾“å…¥: {'location': 'London'}
å·¥å…· ID: toolu_016xHQWMR4JsKtWvH9nbsZyA
=== åˆå§‹å“åº”ç»“æŸ ===


=== å·¥å…·ä½¿ç”¨è¿­ä»£ 1 ===

=== æ‰§è¡Œå·¥å…· ===
å·¥å…·åç§°: weather
è¦æ£€æŸ¥çš„ä½ç½®: London
ç»“æœ: {'temperature': 62, 'condition': 'Cloudy'}
=== å·¥å…·æ‰§è¡Œå®Œæˆ ===


=== å‘é€å¸¦æœ‰å·¥å…·ç»“æœçš„åç»­è¯·æ±‚ ===

=== åç»­å“åº”ï¼ˆè¿­ä»£ 1ï¼‰===
å“åº” ID: msg_01EhR96Z2Z2t5EDhuWeodUod
åœæ­¢åŸå› : tool_use
å†…å®¹å—: 1 å—

å— 1: ç±»å‹ = tool_use
å·¥å…·: news
å·¥å…·è¾“å…¥é¢„è§ˆ: {'topic': 'technology'}
=== åç»­å“åº”ç»“æŸï¼ˆè¿­ä»£ 1ï¼‰===


=== å·¥å…·ä½¿ç”¨è¿­ä»£ 2 ===

=== æ‰§è¡Œå·¥å…· ===
å·¥å…·åç§°: news
è¦æ£€æŸ¥çš„ä¸»é¢˜: technology
ç»“æœ: {'headlines': ['ç ”ç©¶å®éªŒå®¤å®£å¸ƒäº†æ–°çš„äººå·¥æ™ºèƒ½çªç ´', 'ç§‘æŠ€å…¬å¸å‘å¸ƒäº†æœ€æ–°çš„æ™ºèƒ½æ‰‹æœºå‹å·', 'é‡å­è®¡ç®—è¾¾åˆ°äº†é‡Œç¨‹ç¢‘å¼çš„æˆå°±']}
=== å·¥å…·æ‰§è¡Œå®Œæˆ ===


=== å‘é€å¸¦æœ‰å·¥å…·ç»“æœçš„åç»­è¯·æ±‚ ===

=== åç»­å“åº”ï¼ˆè¿­ä»£ 2ï¼‰===
å“åº” ID: msg_01WUEfC4UxPFaJaktjVDMJEN
åœæ­¢åŸå› : end_turn
å†…å®¹å—: 1 å—

å— 1: ç±»å‹ = text
æ–‡æœ¬å†…å®¹é¢„è§ˆ: è¿™æ˜¯æ‚¨è¦æ±‚çš„ä¿¡æ¯ï¼š

## ä¼¦æ•¦å¤©æ°”
ç›®å‰ï¼Œä¼¦æ•¦å¤©æ°”ä¸º 62Â°Fï¼Œå¤šäº‘ã€‚
...
=== åç»­å“åº”ç»“æŸï¼ˆè¿­ä»£ 2ï¼‰===


=== æœ€ç»ˆå“åº” ===

==== å®Œæ•´å“åº” ====

âœ“ æœ€ç»ˆç­”æ¡ˆ:
è¿™æ˜¯æ‚¨è¦æ±‚çš„ä¿¡æ¯ï¼š

## ä¼¦æ•¦å¤©æ°”
ç›®å‰ï¼Œä¼¦æ•¦å¤©æ°”ä¸º 62Â°Fï¼Œå¤šäº‘ã€‚

## æœ€æ–°ç§‘æŠ€æ–°é—»å¤´æ¡

- ç ”ç©¶å®éªŒå®¤å®£å¸ƒäº†æ–°çš„äººå·¥æ™ºèƒ½çªç ´
- ç§‘æŠ€å…¬å¸å‘å¸ƒäº†æœ€æ–°çš„æ™ºèƒ½æ‰‹æœºå‹å·
- é‡å­è®¡ç®—è¾¾åˆ°äº†é‡Œç¨‹ç¢‘å¼çš„æˆå°±

==== å“åº”ç»“æŸ ====
=== æœ€ç»ˆå“åº”ç»“æŸ ===
</code></pre>

<h2 id="_6">ä¿ç•™æ€è€ƒå—</h2>
<p>åœ¨å¤„ç†æ‰©å±•æ€è€ƒå’Œå·¥å…·æ—¶ï¼Œè¯·åŠ¡å¿…ï¼š</p>
<ol>
<li>
<p><strong>ä¿ç•™æ€è€ƒå—ç­¾å</strong>ï¼šæ¯ä¸ªæ€è€ƒå—éƒ½åŒ…å«ä¸€ä¸ªåŠ å¯†ç­¾åï¼Œç”¨äºéªŒè¯å¯¹è¯ä¸Šä¸‹æ–‡ã€‚åœ¨å°†æ€è€ƒå—ä¼ é€’å› Claude æ—¶ï¼Œå¿…é¡»åŒ…å«è¿™äº›ç­¾åã€‚</p>
</li>
<li>
<p><strong>é¿å…ä¿®æ”¹å…ˆå‰ä¸Šä¸‹æ–‡</strong>ï¼šåœ¨æäº¤åŒ…å«å·¥å…·ç»“æœçš„æ–°è¯·æ±‚æ—¶ï¼Œå¦‚æœä¿®æ”¹äº†ä»»ä½•å…ˆå‰çš„å†…å®¹ï¼ˆåŒ…æ‹¬æ€è€ƒå—ï¼‰ï¼ŒAPI å°†ä¼šæ‹’ç»ã€‚</p>
</li>
<li>
<p><strong>åŒæ—¶å¤„ç†æ€è€ƒå’Œå·²ç¼–è¾‘çš„æ€è€ƒå—</strong>ï¼šè¿™ä¸¤ç§ç±»å‹çš„å—éƒ½å¿…é¡»ä¿ç•™åœ¨å¯¹è¯å†å²ä¸­ï¼Œå³ä½¿å·²ç¼–è¾‘å—çš„å†…å®¹æ— æ³•è¢«äººç±»é˜…è¯»ã€‚</p>
</li>
</ol>
<p>æœ‰å…³ä¸ä½¿ç”¨å·¥å…·çš„æ‰©å±•æ€è€ƒçš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ä¸»è¦çš„â€œæ‰©å±•æ€è€ƒâ€ç¬”è®°æœ¬ã€‚</p>
<pre class="codehilite"><code class="language-python">def thinking_block_preservation_example():
    # å®šä¹‰ä¸€ä¸ªç®€å•çš„å¤©æ°”å·¥å…·
    tools = [
        {
            &quot;name&quot;: &quot;weather&quot;,
            &quot;description&quot;: &quot;è·å–æŸåœ°çš„å½“å‰å¤©æ°”ä¿¡æ¯ã€‚&quot;,
            &quot;input_schema&quot;: {
                &quot;type&quot;: &quot;object&quot;,
                &quot;properties&quot;: {
                    &quot;location&quot;: {
                        &quot;type&quot;: &quot;string&quot;,
                        &quot;description&quot;: &quot;è·å–å¤©æ°”ä¿¡æ¯çš„åœ°ç‚¹ã€‚&quot;
                    }
                },
                &quot;required&quot;: [&quot;location&quot;]
            }
        }
    ]

    def weather(location):
        # æ¨¡æ‹Ÿå¤©æ°”æ•°æ®
        weather_data = {
            &quot;çº½çº¦&quot;: {&quot;temperature&quot;: 72, &quot;condition&quot;: &quot;æ™´æœ—&quot;},
            &quot;ä¼¦æ•¦&quot;: {&quot;temperature&quot;: 62, &quot;condition&quot;: &quot;å¤šäº‘&quot;},
            &quot;ä¸œäº¬&quot;: {&quot;temperature&quot;: 80, &quot;condition&quot;: &quot;éƒ¨åˆ†å¤šäº‘&quot;},
            &quot;å·´é»&quot;: {&quot;temperature&quot;: 65, &quot;condition&quot;: &quot;ä¸‹é›¨&quot;},
            &quot;æ‚‰å°¼&quot;: {&quot;temperature&quot;: 85, &quot;condition&quot;: &quot;æ™´æœ—&quot;},
            &quot;æŸæ—&quot;: {&quot;temperature&quot;: 60, &quot;condition&quot;: &quot;æœ‰é›¾&quot;},
        }

        return weather_data.get(location, {&quot;error&quot;: f&quot;æ— æ³•è·å– {location} çš„å¤©æ°”æ•°æ®&quot;})

    # å¸¦æœ‰å·¥å…·ä½¿ç”¨å’Œæ€è€ƒçš„åˆå§‹è¯·æ±‚
    response = client.messages.create(
        model=MODEL_NAME,
        max_tokens=MAX_TOKENS,
        thinking={
            &quot;type&quot;: &quot;enabled&quot;,
            &quot;budget_tokens&quot;: THINKING_BUDGET_TOKENS
        },
        tools=tools,
        messages=[{
            &quot;role&quot;: &quot;user&quot;,
            &quot;content&quot;: &quot;æŸæ—ç°åœ¨å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ&quot;
        }]
    )

    # ä»å“åº”ä¸­æå–å—
    thinking_blocks = [b for b in response.content if b.type == &quot;thinking&quot;]
    tool_use_blocks = [b for b in response.content if b.type == &quot;tool_use&quot;]

    print(&quot;\n=== åˆå§‹å“åº” ===&quot;)
    print(f&quot;å“åº”åŒ…å«:&quot;)
    print(f&quot;- {len(thinking_blocks)} ä¸ªæ€è€ƒå—&quot;)
    print(f&quot;- {len(tool_use_blocks)} ä¸ªå·¥å…·ä½¿ç”¨å—&quot;)

    # æ£€æŸ¥æ˜¯å¦è§¦å‘äº†å·¥å…·ä½¿ç”¨
    if tool_use_blocks:
        tool_block = tool_use_blocks[0]
        print(f&quot;\nè°ƒç”¨çš„å·¥å…·: {tool_block.name}&quot;)
        print(f&quot;è¦æ£€æŸ¥çš„ä½ç½®: {tool_block.input['location']}&quot;)

        # æ‰§è¡Œå·¥å…·
        tool_result = weather(tool_block.input[&quot;location&quot;])
        print(f&quot;å·¥å…·ç»“æœ: {tool_result}&quot;)

        # é¦–å…ˆï¼Œæˆ‘ä»¬å°è¯•ä¸åŒ…å«æ€è€ƒå—
        print(&quot;\n=== æµ‹è¯• 1ï¼šä¸åŒ…å«æ€è€ƒå— ===&quot;)
        try:
            # æ³¨æ„æˆ‘ä»¬åªåŒ…å« tool_use å—ï¼Œä¸åŒ…å«æ€è€ƒå—
            partial_blocks = tool_use_blocks

            incomplete_response = client.messages.create(
                model=MODEL_NAME,
                max_tokens=MAX_TOKENS,
                thinking={
                        &quot;type&quot;: &quot;enabled&quot;,
                        &quot;budget_tokens&quot;: THINKING_BUDGET_TOKENS
                },
                tools=tools,
                messages=[
                    {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;æŸæ—ç°åœ¨å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ&quot;},
                    {&quot;role&quot;: &quot;assistant&quot;, &quot;content&quot;: partial_blocks},
                    {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: [{
                        &quot;type&quot;: &quot;tool_result&quot;,
                        &quot;tool_use_id&quot;: tool_block.id,
                        &quot;content&quot;: json.dumps(tool_result)
                    }]}
                ]
            )
            print(&quot;æˆåŠŸï¼šåœ¨æ²¡æœ‰æ€è€ƒå—çš„æƒ…å†µä¸‹æ”¶åˆ°äº†å“åº”ï¼ˆä¸ç¬¦åˆé¢„æœŸï¼‰&quot;)
        except Exception as e:
            print(f&quot;é”™è¯¯: {e}&quot;)
            print(&quot;è¿™è¡¨æ˜å¿…é¡»ä¿ç•™æ€è€ƒå—&quot;)

        # ç°åœ¨å°è¯•åŒ…å«æ€è€ƒå—ï¼ˆæ­£ç¡®æ–¹æ³•ï¼‰
        print(&quot;\n=== æµ‹è¯• 2ï¼šåŒ…å«æ€è€ƒå—ï¼ˆæ­£ç¡®æ–¹æ³•ï¼‰===&quot;)
        try:
            # åŒ…å«å“åº”ä¸­çš„æ‰€æœ‰å—
            complete_blocks = thinking_blocks + tool_use_blocks

            complete_response = client.messages.create(
                model=MODEL_NAME,
                max_tokens=MAX_TOKENS,
                thinking={
                    &quot;type&quot;: &quot;enabled&quot;,
                    &quot;budget_tokens&quot;: THINKING_BUDGET_TOKENS
                },
                tools=tools,
                messages=[
                    {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;æŸæ—ç°åœ¨å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ&quot;},
                    {&quot;role&quot;: &quot;assistant&quot;, &quot;content&quot;: complete_blocks},
                    {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: [{
                        &quot;type&quot;: &quot;tool_result&quot;,
                        &quot;tool_use_id&quot;: tool_block.id,
                        &quot;content&quot;: json.dumps(tool_result)
                    }]}
                ]
            )
            print(&quot;æˆåŠŸï¼šåœ¨åŒ…å«æ€è€ƒå—çš„æƒ…å†µä¸‹æ”¶åˆ°äº†å“åº”&quot;)

            # æ£€æŸ¥ç¬¬äºŒä¸ªå“åº”æ˜¯å¦åŒ…å«æ€è€ƒå—
            second_thinking = [b for b in complete_response.content if b.type == &quot;thinking&quot;]
            second_text = [b for b in complete_response.content if b.type == &quot;text&quot;]

            print(f&quot;\nç¬¬äºŒä¸ªå“åº”åŒ…å«:&quot;)
            print(f&quot;- {len(second_thinking)} ä¸ªæ€è€ƒå—&quot;)
            print(f&quot;- {len(second_text)} ä¸ªæ–‡æœ¬å—&quot;)

            if second_text:
                print(f&quot;\næœ€ç»ˆç­”æ¡ˆ: {second_text[0].text}&quot;)

            print(&quot;\næ³¨æ„ï¼šå·¥å…·ä½¿ç”¨åçš„ç¬¬äºŒä¸ªå“åº”ä¸åŒ…å«æ€è€ƒå—ã€‚&quot;)
            print(&quot;è¿™æ˜¯é¢„æœŸçš„è¡Œä¸º - æ€è€ƒåœ¨å·¥å…·ä½¿ç”¨å‰æ˜¾ç¤ºï¼Œä½†åœ¨æ”¶åˆ°å·¥å…·ç»“æœåä¸æ˜¾ç¤ºã€‚&quot;)

        except Exception as e:
            print(f&quot;é”™è¯¯: {e}&quot;)

# å–æ¶ˆæ³¨é‡Šä»¥è¿è¡Œç¤ºä¾‹
thinking_block_preservation_example()
</code></pre>

<pre class="codehilite"><code>=== åˆå§‹å“åº” ===
å“åº”åŒ…å«:

- 1 ä¸ªæ€è€ƒå—
- 1 ä¸ªå·¥å…·ä½¿ç”¨å—

è°ƒç”¨çš„å·¥å…·: weather
è¦æ£€æŸ¥çš„ä½ç½®: Berlin
å·¥å…·ç»“æœ: {'temperature': 60, 'condition': 'Foggy'}

=== æµ‹è¯• 1ï¼šä¸åŒ…å«æ€è€ƒå— ===
é”™è¯¯: é”™è¯¯ä»£ç : 400 - {'type': 'error', 'error': {'type': 'invalid_request_error', 'message': 'messages.1.content.0.type: é¢„æœŸä¸º `thinking` æˆ– `redacted_thinking`ï¼Œä½†å‘ç°ä¸º `tool_use`ã€‚å½“å¯ç”¨ `thinking` æ—¶ï¼Œæœ€åçš„ `assistant` æ¶ˆæ¯å¿…é¡»ä»¥æ€è€ƒå—å¼€å¤´ï¼ˆä½äºæœ€åè®¾ç½®çš„ `tool_use` å’Œ `tool_result` å—ä¹‹å‰ï¼‰ã€‚æˆ‘ä»¬å»ºè®®æ‚¨åŒ…å«ä¹‹å‰çš„æ€è€ƒå—ã€‚è¦é¿å…æ­¤è¦æ±‚ï¼Œè¯·ç¦ç”¨ `thinking`ã€‚è¯·æŸ¥é˜…æˆ‘ä»¬çš„æ–‡æ¡£ https://docs.anthropic.com/en/docs/build-with-claude/extended-thinking'}}
è¿™è¡¨æ˜å¿…é¡»ä¿ç•™æ€è€ƒå—

=== æµ‹è¯• 2ï¼šåŒ…å«æ€è€ƒå—ï¼ˆæ­£ç¡®æ–¹æ³•ï¼‰===
æˆåŠŸï¼šåœ¨åŒ…å«æ€è€ƒå—çš„æƒ…å†µä¸‹æ”¶åˆ°äº†å“åº”

ç¬¬äºŒä¸ªå“åº”åŒ…å«:

- 0 ä¸ªæ€è€ƒå—
- 1 ä¸ªæ–‡æœ¬å—

æœ€ç»ˆç­”æ¡ˆ: ç›®å‰æŸæ—å¤©æ°”ä¸º 60Â°Fï¼ˆçº¦ 15.5Â°Cï¼‰ï¼Œæœ‰é›¾ã€‚

æ³¨æ„ï¼šå·¥å…·ä½¿ç”¨åçš„ç¬¬äºŒä¸ªå“åº”ä¸åŒ…å«æ€è€ƒå—ã€‚
è¿™æ˜¯é¢„æœŸçš„è¡Œä¸º - æ€è€ƒåœ¨å·¥å…·ä½¿ç”¨å‰æ˜¾ç¤ºï¼Œä½†åœ¨æ”¶åˆ°å·¥å…·ç»“æœåä¸æ˜¾ç¤ºã€‚
</code></pre>

<h2 id="_7">ç»“è®º</h2>
<p>æœ¬ç¬”è®°æœ¬å±•ç¤ºäº†å¦‚ä½•å°† Claude çš„æ‰©å±•æ€è€ƒåŠŸèƒ½ä¸å·¥å…·ä½¿ç”¨ç›¸ç»“åˆã€‚ä¸»è¦ä¼˜ç‚¹åŒ…æ‹¬ï¼š</p>
<ol>
<li>ä½¿ç”¨å·¥å…·æ—¶ Claude æ€è€ƒè¿‡ç¨‹çš„é€æ˜åº¦</li>
<li>Claude å†³å®šä½•æ—¶ä½¿ç”¨å·¥å…·ä¸å†…éƒ¨çŸ¥è¯†çš„å¯è§æ€§</li>
<li>å¯¹æ¶‰åŠå¤šé¡¹å·¥å…·è°ƒç”¨çš„å¤šæ­¥ä»»åŠ¡çš„æ›´å¥½ç†è§£</li>
<li>å¯¹ Claude å¦‚ä½•è§£é‡Šå·¥å…·ç»“æœå¹¶å°†å…¶çº³å…¥å“åº”çš„æ´å¯Ÿ</li>
</ol>
<p>åœ¨ä½¿ç”¨æ‰©å±•æ€è€ƒä¸å·¥å…·ç»“åˆä½¿ç”¨æ—¶ï¼Œè¯·è®°ä½ï¼š</p>
<ul>
<li>ä¸ºå¤æ‚ä»»åŠ¡è®¾ç½®é€‚å½“çš„æ€è€ƒé¢„ç®—ï¼ˆæœ€å°‘ 1,024 ä¸ªä»¤ç‰Œï¼‰</li>
<li>åœ¨ä¼ é€’å·¥å…·ç»“æœæ—¶å§‹ç»ˆä¿ç•™æ€è€ƒå—åŠå…¶ç­¾å</li>
<li>åœ¨å¯¹è¯å†å²ä¸­åŒ…å«å¸¸è§„å’Œå·²ç¼–è¾‘çš„æ€è€ƒå—</li>
<li>ç¡®ä¿ç³»ç»Ÿæç¤ºã€å·¥å…·å’Œæ€è€ƒé…ç½®åœ¨è°ƒç”¨ä¹‹é—´åŒ¹é…</li>
<li>é¢„æœŸå·¥å…·ç»“æœå›åˆä¸åŒ…å«é¢å¤–çš„æ€è€ƒå—</li>
<li>å·¥å…·ä½¿ç”¨å’Œæ€è€ƒç»“åˆä½¿ç”¨ä¼šå¢åŠ ä»¤ç‰Œä½¿ç”¨é‡å’Œå“åº”æ—¶é—´</li>
</ul>
            </article>
            
            <nav class="page-nav"><a href="patterns/agents/evaluator_optimizer_zh.html" class="nav-link prev">â† Untitled</a><a href="extended_thinking/extended_thinking_zh.html" class="nav-link next">æ‰©å±•æ€è€ƒ â†’</a></nav>
        </main>
    </div>
</body>
</html>
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../">
    <title>æŠ•æœºæ€§æç¤ºç¼“å­˜</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="stylesheet" href="assets/highlight.css">
    <script src="assets/script.js" defer></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: false,
                packages: {'[+]': ['noerrors', 'ams']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            loader: {
                load: ['[tex]/noerrors', '[tex]/ams']
            }
        };
    </script>
</head>
<body>
    <div class="container">
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h3>ç›®å½•</h3>
                <button id="sidebar-toggle" class="sidebar-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
            <div class="sidebar-search">
                <input type="text" id="sidebar-search-input" placeholder="æœç´¢..." autocomplete="off">
            </div>
            <div id="tree-container">
                <nav class="tree-nav" role="tree">
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">extended_thinking</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="extended_thinking/extended_thinking_with_tool_use_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ‰©å±•æ€è€ƒä¸å·¥å…·ä½¿ç”¨</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="extended_thinking/extended_thinking_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ‰©å±•æ€è€ƒ</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">finetuning</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="finetuning/finetuning_on_bedrock_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">åœ¨ Bedrock ä¸Šå¾®è°ƒ Claude 3 Haiku</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder expanded" data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">misc</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/batch_processing_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ‰¹é‡å¤„ç†æ¶ˆæ¯æ‰¹æ¬¡API</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/building_evals_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å»ºç«‹è¯„ä¼°</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/building_moderation_filter_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å»ºç«‹ä¸€ä¸ªå¸¦æœ‰ Claude çš„å®¡æ ¸è¿‡æ»¤å™¨</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/generate_test_cases_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰ `extract_variables` å‡½æ•°ï¼Œ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/how_to_enable_json_mode_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æç¤º Claude è·å–â€œJSON æ¨¡å¼â€</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/how_to_make_sql_queries_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¦‚ä½•ä½¿ç”¨ Claude è¿›è¡Œ SQL æŸ¥è¯¢</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/illustrated_responses_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude çš„å›¾ç¤ºåŒ–å“åº”</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/mc_qa_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å®éªŒæ€§æµ‹è¯• Claude çš„é•¿ä¸Šä¸‹æ–‡é—®ç­”èƒ½åŠ›</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/metaprompt_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Metaprompt</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/pdf_upload_summarization_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">â€œä¸Šä¼ â€PDF åˆ° Claude API</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/prompt_caching_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¼“å­˜æç¤ºï¼ˆPrompt cachingï¼‰é€šè¿‡ Anthropic API</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/read_web_pages_with_haiku_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Claude 3 Haiku æ€»ç»“ç½‘é¡µå†…å®¹</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/sampling_past_max_tokens_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude ä» Claude ä¹‹å¤–çš„é‡‡æ ·å“åº”ï¼Œè¶…å‡ºæœ€å¤§ä»¤ç‰Œé™åˆ¶</span>
                        </a>
                    </div>
                
                    <div class="tree-item active" style="padding-left: 20px;">
                        <a href="misc/speculative_prompt_caching_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æŠ•æœºæ€§æç¤ºç¼“å­˜</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="misc/using_citations_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¼•è¨€</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">multimodal</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/best_practices_for_vision_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/getting_started_with_vision_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¼€å§‹ä¸Šæ‰‹ - å¦‚ä½•å°†å›¾åƒä¼ é€’ç»™ Claude</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/how_to_transcribe_text_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¦‚ä½•ä½¿ç”¨ Claude è½¬å½•æ–‡æ¡£</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/reading_charts_graphs_powerpoints_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨å›¾è¡¨å’Œå¹»ç¯ç‰‡æ”¾æ˜ </span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="multimodal/using_sub_agents_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Haiku ä½œä¸ºå­ä»£ç†</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">patterns</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">agents</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="patterns/agents/basic_workflows_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">é¦–å…ˆä½¿ç”¨å…·æœ‰æ€ç»´é“¾çš„LLMç¡®å®šé€‚å½“çš„è·¯ç”±</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="patterns/agents/evaluator_optimizer_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="patterns/agents/orchestrator_workers_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ­¥éª¤1ï¼šè·å–åè°ƒå™¨å“åº”</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="patterns/agents/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ„å»ºé«˜æ•ˆä»£ç†çš„é£Ÿè°±</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">prompts</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="patterns/agents/prompts/citations_agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="patterns/agents/prompts/research_lead_agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="patterns/agents/prompts/research_subagent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                </div></div></div></div></div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">skills</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="skills/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude æŠ€èƒ½</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">classification</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/classification/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è®¾ç½®æˆ‘ä»¬çš„ç¯å¢ƒ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/classification/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude åˆ†ç±»æŒ‡å—</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">evaluation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="skills/classification/evaluation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Promptfoo è¿›è¡Œè¯„ä¼°</span>
                        </a>
                    </div>
                </div></div></div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">contextual-embeddings</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/contextual-embeddings/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¢å¼ºæ£€ç´¢çš„RAGä¸ä¸Šä¸‹æ–‡æ£€ç´¢</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/contextual-embeddings/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç»“åˆä¸Šä¸‹æ–‡åµŒå…¥çš„æ£€ç´¢å¢å¼ºç”Ÿæˆ</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">retrieval_augmented_generation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/retrieval_augmented_generation/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Retrieval Augmented Generation (RAG)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/retrieval_augmented_generation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">evaluation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="skills/retrieval_augmented_generation/evaluation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Promptfoo è¿›è¡Œè¯„ä¼°</span>
                        </a>
                    </div>
                </div></div></div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">summarization</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/summarization/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ‘˜è¦ä¸ Claude</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/summarization/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude æ‘˜è¦</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">evaluation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="skills/summarization/evaluation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Promptfoo è¯„ä¼°</span>
                        </a>
                    </div>
                </div></div></div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">text_to_sql</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/text_to_sql/guide_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Set your Anthropic API key</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="skills/text_to_sql/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Claude çš„æ–‡æœ¬åˆ° SQL</span>
                        </a>
                    </div>
                
                    <div class="tree-folder " data-level="2" style="padding-left: 40px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">evaluation</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 60px;">
                        <a href="skills/text_to_sql/evaluation/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Promptfoo è¯„ä¼°</span>
                        </a>
                    </div>
                </div></div></div></div></div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">third_party</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">Deepgram</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/Deepgram/prerecorded_audio_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è½¬å½•æ·±è“éŸ³é¢‘æ–‡ä»¶å¹¶ä½¿ç”¨ Anthropic å‡†å¤‡é¢è¯•é—®é¢˜ï¼</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/Deepgram/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Deepgram <> Anthropic Cookbooks</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">LlamaIndex</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/Basic_RAG_With_LlamaIndex_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">RAG ç®¡é“ä¸ LlamaIndex</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/Multi_Document_Agents_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¤šæ–‡æ¡£ä»£ç†</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/Multi_Modal_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¤šæ¨¡æ€</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/ReAct_Agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ReAct Agent</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/README_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">LlamaIndex <> Anthropic Cookbooks</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/Router_Query_Engine_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ³¨æ„ï¼šè¿™ä»…åœ¨ jupyter notebook ä¸­æ˜¯å¿…éœ€çš„ã€‚</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/LlamaIndex/SubQuestion_Query_Engine_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">SubQuestionQueryEngine</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">MongoDB</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/MongoDB/rag_using_mongodb_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å¦‚ä½•ä½¿ç”¨ Claude 3 å’Œ MongoDB æ„å»º RAG ç³»ç»Ÿ</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">Pinecone</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/Pinecone/claude_3_rag_agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">æ£€æŸ¥ Python ç‰ˆæœ¬</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/Pinecone/rag_using_pinecone_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Pinecone è¿›è¡Œæ£€ç´¢å¢å¼ºç”Ÿæˆ</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">VoyageAI</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/VoyageAI/how_to_create_embeddings_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è¿™å°†è‡ªåŠ¨ä½¿ç”¨ç¯å¢ƒå˜é‡VOYAGE_API_KEYã€‚</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">Wikipedia</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/Wikipedia/wikipedia-search-cookbook_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è¿­ä»£æœç´¢ç»´åŸºç™¾ç§‘ä¸ Claude</span>
                        </a>
                    </div>
                </div></div>
                    <div class="tree-folder " data-level="1" style="padding-left: 20px;">
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">WolframAlpha</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 40px;">
                        <a href="third_party/WolframAlpha/using_llm_api_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Wolfram Alpha LLM API ä½œä¸º Claude çš„å·¥å…·</span>
                        </a>
                    </div>
                </div></div></div></div>
                    <div class="tree-folder " data-level="0" >
                        <div class="tree-folder-header">
                            <span class="tree-arrow">â–¶</span>
                            <span class="tree-icon"></span>
                            <span class="tree-title">tool_use</span>
                        </div>
                        <div class="tree-folder-content">
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/calculator_tool_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨è®¡ç®—å™¨å·¥å…·ä¸ Claude</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/customer_service_agent_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨å®¢æˆ·ç«¯å·¥å…·åˆ›å»ºå®¢æœä»£ç†</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/extracting_structured_json_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Claude å’Œå·¥å…·ä½¿ç”¨åŠŸèƒ½æå–ç»“æ„åŒ– JSON</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/memory_cookbook_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">å®‰è£…ä¾èµ–</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/parallel_tools_claude_3_7_sonnet_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">åœ¨ Claude 3.7 Sonnet ä¸Šå¹¶è¡Œè°ƒç”¨å·¥å…·</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/tool_choice_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">é€‰æ‹©å·¥å…·</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/tool_use_with_pydantic_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">è®°äº‹å·¥å…·ï¼Œæ”¯æŒ Pydantic å’Œ Anthropic å·¥å…·ä½¿ç”¨</span>
                        </a>
                    </div>
                
                    <div class="tree-item " style="padding-left: 20px;">
                        <a href="tool_use/vision_with_tools_zh.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ä½¿ç”¨ Vision ä¸å·¥å…·</span>
                        </a>
                    </div>
                </div></div></nav>
            </div>
        </nav>
        
        <main class="content">
            <article>
                <h1 id="_1">æŠ•æœºæ€§æç¤ºç¼“å­˜</h1>
<p>æœ¬é£Ÿè°±æ¼”ç¤ºäº†â€œæŠ•æœºæ€§æç¤ºç¼“å­˜â€â€”â€”ä¸€ç§é€šè¿‡åœ¨ç”¨æˆ·ä»åœ¨åˆ¶å®šæŸ¥è¯¢æ—¶é¢„çƒ­ç¼“å­˜æ¥å‡å°‘é¦–æ¬¡ä»¤ç‰Œæ—¶é—´ï¼ˆTTFTï¼‰çš„æ¨¡å¼ã€‚</p>
<p><strong>æ— æŠ•æœºç¼“å­˜ï¼š</strong></p>
<ol>
<li>ç”¨æˆ·é”®å…¥é—®é¢˜ï¼ˆ3 ç§’ï¼‰</li>
<li>ç”¨æˆ·æäº¤é—®é¢˜</li>
<li>API å°†ä¸Šä¸‹æ–‡åŠ è½½åˆ°ç¼“å­˜ä¸­å¹¶ç”Ÿæˆå“åº”</li>
</ol>
<p><strong>æœ‰æŠ•æœºç¼“å­˜ï¼š</strong></p>
<ol>
<li>ç”¨æˆ·å¼€å§‹é”®å…¥ï¼ˆç¼“å­˜é¢„çƒ­ç«‹å³å¼€å§‹ï¼‰</li>
<li>ç”¨æˆ·ç»§ç»­é”®å…¥ï¼ˆç¼“å­˜é¢„çƒ­åœ¨åå°å®Œæˆï¼‰</li>
<li>ç”¨æˆ·æäº¤é—®é¢˜</li>
<li>API ä½¿ç”¨é¢„çƒ­çš„ç¼“å­˜ç”Ÿæˆå“åº”</li>
</ol>
<h2 id="_2">è®¾ç½®</h2>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®‰è£…æ‰€éœ€çš„åŒ…ï¼š</p>
<pre class="codehilite"><code class="language-python">%pip install anthropic httpx --quiet
</code></pre>

<p>æ³¨æ„ï¼šæ‚¨å¯èƒ½éœ€è¦é‡æ–°å¯åŠ¨å†…æ ¸æ‰èƒ½ä½¿ç”¨æ›´æ–°çš„åŒ…ã€‚</p>
<pre class="codehilite"><code class="language-python">import copy
import datetime
import time
import asyncio
import httpx
from anthropic import AsyncAnthropic

# é…ç½®å¸¸é‡
MODEL = &quot;claude-3-5-sonnet-20241022&quot;
SQLITE_SOURCES = {
    &quot;btree.h&quot;: &quot;https://sqlite.org/src/raw/18e5e7b2124c23426a283523e5f31a4bff029131b795bb82391f9d2f3136fc50?at=btree.h&quot;,
    &quot;btree.c&quot;: &quot;https://sqlite.org/src/raw/63ca6b647342e8cef643863cd0962a542f133e1069460725ba4461dcda92b03c?at=btree.c&quot;,
}
DEFAULT_CLIENT_ARGS = {
    &quot;system&quot;: &quot;æ‚¨æ˜¯ä¸€ä½å¸®åŠ©åˆ†ææ•°æ®åº“å†…éƒ¨çš„ä¸“å®¶ç³»ç»Ÿç¨‹åºå‘˜ã€‚&quot;,
    &quot;max_tokens&quot;: 4096,
    &quot;temperature&quot;: 0,
    &quot;extra_headers&quot;: {&quot;anthropic-beta&quot;: &quot;prompt-caching-2024-07-31&quot;},
}
</code></pre>

<h2 id="_3">è¾…åŠ©å‡½æ•°</h2>
<p>è®©æˆ‘ä»¬è®¾ç½®ä¸‹è½½å¤§å‹ä¸Šä¸‹æ–‡å’Œå‡†å¤‡æ¶ˆæ¯çš„å‡½æ•°ï¼š</p>
<pre class="codehilite"><code class="language-python">async def get_sqlite_sources() -&gt; dict[str, str]:
    print(&quot;æ­£åœ¨ä¸‹è½½ SQLite æºæ–‡ä»¶...&quot;)

    source_files = {}
    start_time = time.time()

    async with httpx.AsyncClient(timeout=30.0) as client:
        tasks = []

        async def download_file(filename: str, url: str) -&gt; tuple[str, str]:
            response = await client.get(url, follow_redirects=True)
            response.raise_for_status()
            print(f&quot;æˆåŠŸä¸‹è½½ {filename}&quot;)
            return filename, response.text

        for filename, url in SQLITE_SOURCES.items():
            tasks.append(download_file(filename, url))

        results = await asyncio.gather(*tasks)
        source_files = dict(results)

    duration = time.time() - start_time
    print(f&quot;åœ¨ {duration:.2f} ç§’å†…ä¸‹è½½äº† {len(source_files)} ä¸ªæ–‡ä»¶&quot;)
    return source_files


async def create_initial_message():
    sources = await get_sqlite_sources()
    # ä½¿ç”¨æºä»£ç ä½œä¸ºä¸Šä¸‹æ–‡å‡†å¤‡åˆå§‹æ¶ˆæ¯ã€‚
    # åŒ…å«æ—¶é—´æˆ³ä»¥é˜²æ­¢ä¸åŒè¿è¡Œä¹‹é—´çš„ç¼“å­˜å…±äº«ã€‚
    initial_message = {
        &quot;role&quot;: &quot;user&quot;,
        &quot;content&quot;: [
            {
                &quot;type&quot;: &quot;text&quot;,
                &quot;text&quot;: f&quot;&quot;&quot;
å½“å‰æ—¶é—´ï¼š{datetime.datetime.now().strftime(&quot;%Y-%m-%d %H:%M:%S&quot;)}

è¦åˆ†æçš„æ¥æºï¼š

btree.h:
```c
{sources[&quot;btree.h&quot;]}
</code></pre>

<p>btree.c:</p>
<pre class="codehilite"><code class="language-c">{sources[&quot;btree.c&quot;]}
```&quot;&quot;&quot;,
                &quot;cache_control&quot;: {&quot;type&quot;: &quot;ephemeral&quot;},
            }
        ],
    }
    return initial_message


async def sample_one_token(client: AsyncAnthropic, messages: list):
    &quot;&quot;&quot;å‘é€å•ä¸ªä»¤ç‰Œè¯·æ±‚ä»¥é¢„çƒ­ç¼“å­˜&quot;&quot;&quot;
    args = copy.deepcopy(DEFAULT_CLIENT_ARGS)
    args[&quot;max_tokens&quot;] = 1
    await client.messages.create(
        messages=messages,
        model=MODEL,
        **args,
    )


def print_query_statistics(response, query_type: str) -&gt; None:
    print(f&quot;\n{query_type} æŸ¥è¯¢ç»Ÿè®¡ï¼š&quot;)
    print(f&quot;\tè¾“å…¥ä»¤ç‰Œæ•°ï¼š{response.usage.input_tokens}&quot;)
    print(f&quot;\tè¾“å‡ºä»¤ç‰Œæ•°ï¼š{response.usage.output_tokens}&quot;)
    print(
        f&quot;\tç¼“å­˜è¯»å–è¾“å…¥ä»¤ç‰Œæ•°ï¼š{getattr(response.usage, 'cache_read_input_tokens', '---')}&quot;
    )
    print(
        f&quot;\tç¼“å­˜åˆ›å»ºè¾“å…¥ä»¤ç‰Œæ•°ï¼š{getattr(response.usage, 'cache_creation_input_tokens', '---')}&quot;
    )
</code></pre>

<h2 id="1">ç¤ºä¾‹ 1ï¼šæ ‡å‡†æç¤ºç¼“å­˜ï¼ˆæ— æŠ•æœºç¼“å­˜ï¼‰</h2>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æ ‡å‡†çš„æç¤ºç¼“å­˜æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ç”¨æˆ·é”®å…¥ä»–ä»¬çš„é—®é¢˜ï¼Œç„¶åæˆ‘ä»¬å°†æ•´ä¸ªä¸Šä¸‹æ–‡+é—®é¢˜å‘é€ç»™ APIï¼š</p>
<pre class="codehilite"><code class="language-python">async def standard_prompt_caching_demo():
    client = AsyncAnthropic()

    # å‡†å¤‡å¤§å‹ä¸Šä¸‹æ–‡
    initial_message = await create_initial_message()

    # æ¨¡æ‹Ÿç”¨æˆ·é”®å…¥æ—¶é—´ï¼ˆåœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™å°†æ˜¯å®é™…çš„ç”¨æˆ·è¾“å…¥ï¼‰
    print(&quot;ç”¨æˆ·æ­£åœ¨é”®å…¥ä»–ä»¬çš„é—®é¢˜...&quot;)
    await asyncio.sleep(3)  # æ¨¡æ‹Ÿ 3 ç§’é”®å…¥æ—¶é—´
    user_question = &quot;BtShared ç»“æ„çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ&quot;
    print(f&quot;ç”¨æˆ·æäº¤ï¼š{user_question}&quot;)

    # ç°åœ¨å‘é€å®Œæ•´è¯·æ±‚ï¼ˆä¸Šä¸‹æ–‡ + é—®é¢˜ï¼‰
    full_message = copy.deepcopy(initial_message)
    full_message[&quot;content&quot;].append(
        {&quot;type&quot;: &quot;text&quot;, &quot;text&quot;: f&quot;å›ç­”ç”¨æˆ·çš„é—®é¢˜ï¼š{user_question}&quot;}
    )

    print(&quot;\næ­£åœ¨å‘ API å‘é€è¯·æ±‚...&quot;)
    start_time = time.time()

    # æµ‹é‡é¦–æ¬¡ä»¤ç‰Œæ—¶é—´
    first_token_time = None
    async with client.messages.stream(
        messages=[full_message],
        model=MODEL,
        **DEFAULT_CLIENT_ARGS,
    ) as stream:
        async for text in stream.text_stream:
            if first_token_time is None and text.strip():
                first_token_time = time.time() - start_time
                print(f&quot;\nğŸ• é¦–æ¬¡ä»¤ç‰Œæ—¶é—´ï¼š{first_token_time:.2f} ç§’&quot;)
                break

        # è·å–å®Œæ•´å“åº”
        response = await stream.get_final_message()

    total_time = time.time() - start_time
    print(f&quot;æ€»å“åº”æ—¶é—´ï¼š{total_time:.2f} ç§’&quot;)
    print_query_statistics(response, &quot;æ ‡å‡†ç¼“å­˜&quot;)

    return first_token_time, total_time
</code></pre>

<pre class="codehilite"><code class="language-python"># è¿è¡Œæ ‡å‡†æ¼”ç¤º
standard_ttft, standard_total = await standard_prompt_caching_demo()
</code></pre>

<p>æ­£åœ¨ä¸‹è½½ SQLite æºæ–‡ä»¶...
æˆåŠŸä¸‹è½½ btree.h
æˆåŠŸä¸‹è½½ btree.c
åœ¨ 0.30 ç§’å†…ä¸‹è½½äº† 2 ä¸ªæ–‡ä»¶
ç”¨æˆ·æ­£åœ¨é”®å…¥ä»–ä»¬çš„é—®é¢˜...
ç”¨æˆ·æäº¤ï¼šBtShared ç»“æ„çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>æ­£åœ¨å‘ API å‘é€è¯·æ±‚...</p>
<p>ğŸ• é¦–æ¬¡ä»¤ç‰Œæ—¶é—´ï¼š20.87 ç§’
æ€»å“åº”æ—¶é—´ï¼š28.32 ç§’</p>
<p>æ ‡å‡†ç¼“å­˜ æŸ¥è¯¢ç»Ÿè®¡ï¼š
    è¾“å…¥ä»¤ç‰Œæ•°ï¼š22
    è¾“å‡ºä»¤ç‰Œæ•°ï¼š362
    ç¼“å­˜è¯»å–è¾“å…¥ä»¤ç‰Œæ•°ï¼š0
    ç¼“å­˜åˆ›å»ºè¾“å…¥ä»¤ç‰Œæ•°ï¼š151629</p>
<h2 id="2">ç¤ºä¾‹ 2ï¼šæŠ•æœºæ€§æç¤ºç¼“å­˜</h2>
<p>ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹æŠ•æœºæ€§æç¤ºç¼“å­˜å¦‚ä½•é€šè¿‡åœ¨ç”¨æˆ·é”®å…¥æ—¶é¢„çƒ­ç¼“å­˜æ¥æ”¹å–„ TTFTï¼š</p>
<pre class="codehilite"><code class="language-python">async def speculative_prompt_caching_demo():
    client = AsyncAnthropic()

    # ç”¨æˆ·å¸Œæœ›ä¸ä¹‹äº¤äº’çš„å¤§é‡ä¸Šä¸‹æ–‡ï¼Œ
    # åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯ sqlite b-tree å®ç°ï¼ˆçº¦ 150k ä»¤ç‰Œï¼‰ã€‚
    initial_message = await create_initial_message()

    # åœ¨ç”¨æˆ·é”®å…¥æ—¶å¼€å§‹æŠ•æœºæ€§ç¼“å­˜
    print(&quot;ç”¨æˆ·æ­£åœ¨é”®å…¥ä»–ä»¬çš„é—®é¢˜...&quot;)
    print(&quot;ğŸ”¥ åœ¨åå°å¼€å§‹ç¼“å­˜é¢„çƒ­...&quot;)

    # åœ¨ç”¨æˆ·é”®å…¥ä»–ä»¬çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬ä»ç”¨æˆ·å°†è¦äº¤äº’çš„ä¸Šä¸‹æ–‡ä¸­é‡‡æ ·å•ä¸ªä»¤ç‰Œ
    # å¹¶æ˜¾å¼å¼€å¯æç¤ºç¼“å­˜ä»¥é¢„çƒ­ç¼“å­˜ã€‚
    cache_task = asyncio.create_task(sample_one_token(client, [initial_message]))

    # æ¨¡æ‹Ÿç”¨æˆ·é”®å…¥æ—¶é—´
    await asyncio.sleep(3)  # æ¨¡æ‹Ÿ 3 ç§’é”®å…¥æ—¶é—´
    user_question = &quot;What is the purpose of the BtShared structure?&quot;
    print(f&quot;ç”¨æˆ·æäº¤ï¼š{user_question}&quot;)

    # ç¡®ä¿ç¼“å­˜é¢„çƒ­å·²å®Œæˆ
    await cache_task
    print(&quot;âœ… ç¼“å­˜é¢„çƒ­å·²å®Œæˆï¼&quot;)

    # å‡†å¤‡ç¼“å­˜æŸ¥è¯¢çš„æ¶ˆæ¯ã€‚æˆ‘ä»¬ç¡®ä¿
    # é‡ç”¨ä¸ç¼“å­˜ç›¸åŒçš„åˆå§‹æ¶ˆæ¯ï¼Œä»¥ç¡®ä¿æˆ‘ä»¬æœ‰ç¼“å­˜å‘½ä¸­ã€‚
    cached_message = copy.deepcopy(initial_message)
    cached_message[&quot;content&quot;].append(
        {&quot;type&quot;: &quot;text&quot;, &quot;text&quot;: f&quot;Answer the user's question: {user_question}&quot;}
    )

    print(&quot;\næ­£åœ¨å‘ API å‘é€è¯·æ±‚ï¼ˆä½¿ç”¨é¢„çƒ­çš„ç¼“å­˜ï¼‰...&quot;)
    start_time = time.time()

    # æµ‹é‡é¦–æ¬¡ä»¤ç‰Œæ—¶é—´
    first_token_time = None
    async with client.messages.stream(
        messages=[cached_message],
        model=MODEL,
        **DEFAULT_CLIENT_ARGS,
    ) as stream:
        async for text in stream.text_stream:
            if first_token_time is None and text.strip():
                first_token_time = time.time() - start_time
                print(f&quot;\nğŸš€ Time to first token: {first_token_time:.2f} seconds&quot;)
                break

        # è·å–å®Œæ•´å“åº”
        response = await stream.get_final_message()

    total_time = time.time() - start_time
    print(f&quot;æ€»å“åº”æ—¶é—´ï¼š{total_time:.2f} ç§’&quot;)
    print_query_statistics(response, &quot;æŠ•æœºæ€§ç¼“å­˜&quot;)

    return first_token_time, total_time
</code></pre>

<pre class="codehilite"><code class="language-python"># è¿è¡ŒæŠ•æœºæ€§ç¼“å­˜æ¼”ç¤º  
speculative_ttft, speculative_total = await speculative_prompt_caching_demo()
</code></pre>

<p>æ­£åœ¨ä¸‹è½½ SQLite æºæ–‡ä»¶...
æˆåŠŸä¸‹è½½ btree.h
æˆåŠŸä¸‹è½½ btree.c
åœ¨ 0.36 ç§’å†…ä¸‹è½½äº† 2 ä¸ªæ–‡ä»¶
ç”¨æˆ·æ­£åœ¨é”®å…¥ä»–ä»¬çš„é—®é¢˜...
ğŸ”¥ åœ¨åå°å¼€å§‹ç¼“å­˜é¢„çƒ­...
ç”¨æˆ·æäº¤ï¼šWhat is the purpose of the BtShared structure?
âœ… ç¼“å­˜é¢„çƒ­å·²å®Œæˆï¼</p>
<p>æ­£åœ¨å‘ API å‘é€è¯·æ±‚ï¼ˆä½¿ç”¨é¢„çƒ­çš„ç¼“å­˜ï¼‰...</p>
<p>ğŸš€ Time to first token: 1.94 seconds
æ€»å“åº”æ—¶é—´ï¼š8.40 ç§’</p>
<p>æŠ•æœºæ€§ç¼“å­˜ æŸ¥è¯¢ç»Ÿè®¡ï¼š
    è¾“å…¥ä»¤ç‰Œæ•°ï¼š22
    è¾“å‡ºä»¤ç‰Œæ•°ï¼š330
    ç¼“å­˜è¯»å–è¾“å…¥ä»¤ç‰Œæ•°ï¼š151629
    ç¼“å­˜åˆ›å»ºè¾“å…¥ä»¤ç‰Œæ•°ï¼š0</p>
<h2 id="_4">æ€§èƒ½æ¯”è¾ƒ</h2>
<p>è®©æˆ‘ä»¬æ¯”è¾ƒç»“æœï¼Œçœ‹çœ‹æŠ•æœºæ€§ç¼“å­˜çš„å¥½å¤„ï¼š</p>
<pre class="codehilite"><code class="language-python">print(&quot;=&quot; * 60)
print(&quot;æ€§èƒ½æ¯”è¾ƒ&quot;)
print(&quot;=&quot; * 60)

print(f&quot;\næ ‡å‡†æç¤ºç¼“å­˜ï¼š&quot;)
print(f&quot;  é¦–æ¬¡ä»¤ç‰Œæ—¶é—´ï¼š{standard_ttft:.2f} ç§’&quot;)
print(f&quot;  æ€»å“åº”æ—¶é—´ï¼š{standard_total:.2f} ç§’&quot;)

print(f&quot;\næŠ•æœºæ€§æç¤ºç¼“å­˜ï¼š&quot;)
print(f&quot;  é¦–æ¬¡ä»¤ç‰Œæ—¶é—´ï¼š{speculative_ttft:.2f} ç§’&quot;)
print(f&quot;  æ€»å“åº”æ—¶é—´ï¼š{speculative_total:.2f} ç§’&quot;)

ttft_improvement = (standard_ttft - speculative_ttft) / standard_ttft * 100
total_improvement = (standard_total - speculative_total) / standard_total * 100

print(f&quot;\nğŸ¯ æ”¹è¿›ï¼š&quot;)
print(f&quot;  TTFT æ”¹è¿›ï¼š{ttft_improvement:.1f}% ({standard_ttft - speculative_ttft:.2f} ç§’æ›´å¿«)&quot;)
print(f&quot;  æ€»æ—¶é—´æ”¹è¿›ï¼š{total_improvement:.1f}% ({standard_total - speculative_total:.2f} ç§’æ›´å¿«)&quot;)
</code></pre>

<p>============================================================
æ€§èƒ½æ¯”è¾ƒ
============================================================</p>
<p>æ ‡å‡†æç¤ºç¼“å­˜ï¼š
  é¦–æ¬¡ä»¤ç‰Œæ—¶é—´ï¼š20.87 ç§’
  æ€»å“åº”æ—¶é—´ï¼š28.32 ç§’</p>
<p>æŠ•æœºæ€§æç¤ºç¼“å­˜ï¼š
  é¦–æ¬¡ä»¤ç‰Œæ—¶é—´ï¼š1.94 ç§’
  æ€»å“åº”æ—¶é—´ï¼š8.40 ç§’</p>
<p>ğŸ¯ æ”¹è¿›ï¼š
  TTFT æ”¹è¿›ï¼š90.7% (18.93 ç§’æ›´å¿«)
  æ€»æ—¶é—´æ”¹è¿›ï¼š70.4% (19.92 ç§’æ›´å¿«)</p>
<h2 id="_5">ä¸»è¦æ”¶è·</h2>
<ol>
<li><strong>æŠ•æœºæ€§ç¼“å­˜é€šè¿‡åœ¨ç”¨æˆ·é”®å…¥æ—¶é¢„çƒ­ç¼“å­˜ï¼Œæå¤§åœ°å‡å°‘äº† TTFT</strong></li>
<li><strong>è¯¥æ¨¡å¼æœ€æœ‰æ•ˆ</strong>äºå¤§å‹ä¸Šä¸‹æ–‡ï¼ˆ&gt;1000 ä»¤ç‰Œï¼‰çš„åœºæ™¯ï¼Œè¿™äº›ä¸Šä¸‹æ–‡è·¨æŸ¥è¯¢é‡ç”¨</li>
<li><strong>å®ç°ç®€å•</strong>â€”â€”åªéœ€åœ¨ç”¨æˆ·é”®å…¥æ—¶å‘é€ä¸€ä¸ªä»¤ç‰Œè¯·æ±‚</li>
<li><strong>ç¼“å­˜é¢„çƒ­ä¸ç”¨æˆ·è¾“å…¥å¹¶è¡Œå‘ç”Ÿ</strong>ï¼Œæœ‰æ•ˆåœ°â€œéšè—â€äº†ç¼“å­˜åˆ›å»ºæ—¶é—´</li>
</ol>
<h2 id="_6">æœ€ä½³å®è·µ</h2>
<ul>
<li>å°½æ—©å¼€å§‹ç¼“å­˜é¢„çƒ­ï¼ˆä¾‹å¦‚ï¼Œå½“ç”¨æˆ·èšç„¦è¾“å…¥å­—æ®µæ—¶ï¼‰</li>
<li>ä½¿ç”¨ä¸å®é™…è¯·æ±‚å®Œå…¨ç›¸åŒçš„ä¸Šä¸‹æ–‡è¿›è¡Œé¢„çƒ­ï¼Œä»¥ç¡®ä¿ç¼“å­˜å‘½ä¸­</li>
<li>ç›‘æ§ <code>cache_read_input_tokens</code> ä»¥éªŒè¯ç¼“å­˜å‘½ä¸­</li>
<li>æ·»åŠ æ—¶é—´æˆ³ä»¥é˜²æ­¢è·¨ä¼šè¯çš„ä¸å¿…è¦ç¼“å­˜å…±äº«</li>
</ul>
            </article>
            
            <nav class="page-nav"><a href="misc/sampling_past_max_tokens_zh.html" class="nav-link prev">â† Claude ä» Claude ä¹‹å¤–çš„é‡‡æ ·å“åº”ï¼Œè¶…å‡ºæœ€å¤§ä»¤ç‰Œé™åˆ¶</a><a href="third_party/LlamaIndex/SubQuestion_Query_Engine_zh.html" class="nav-link next">SubQuestionQueryEngine â†’</a></nav>
        </main>
    </div>
</body>
</html>